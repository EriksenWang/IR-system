{
    "title": "GOCE USER TOOLBOX SPECIFICATION: SCIENTIFIC TRADE OFF STUDY AND ALGORITHM SPECIFICATION",
    "publication_date": "2006",
    "authors": [
        {
            "full_name": "Martin Losch",
            "firstname": "Martin",
            "lastname": "Losch",
            "affiliations": [
                {
                    "organization": "Alfred Wegener Institute for Polar and Marine Research",
                    "address": {
                        "city": "Bremerhaven",
                        "country": "Germany",
                        "postcode": "27515"
                    }
                }
            ]
        },
        {
            "full_name": "Helen Snaith",
            "firstname": "Helen",
            "lastname": "Snaith",
            "affiliations": [
                {
                    "organization": "National Oceanography Centre",
                    "address": {
                        "city": "Southampton Southampton",
                        "country": "UK",
                        "postcode": "SO14 3ZH"
                    }
                }
            ]
        },
        {
            "full_name": "Frank Siegismund",
            "firstname": "Frank",
            "lastname": "Siegismund",
            "affiliations": [
                {
                    "organization": "Institute of Oceanography, University of Hamburg",
                    "address": {
                        "city": "Hamburg",
                        "country": "Germany",
                        "postcode": "D-20146"
                    }
                }
            ]
        }
    ],
    "abstract": "As part of the GOCE User Toolbox Specification (GUTS) project, the GUTS team has carried out a scientific trade-off study, to select the best algorithms to fulfil the user requirements for the toolbox. In some cases the selection is straightforward. However, in other cases, the choice depends on scientific applications as well as the algorithm efficiency and more practical considerations. Studies need to be performed to demonstrate the best possible algorithm. One example is the selection of filtering functions and the choice of interpolation schemes used in calculation of a mean dynamic topography from combined GOCE and satellite altimeter data. The trade-off study has also selected the functionality of the toolbox, given the user requirements and the recommended algorithms. In this paper we present the proposed functionality of the toolbox, and the most important algorithm selections. As part of the scientific trade-off, a pilot application is investigating validation of mean dynamic topography, generated from pseudo observations using proposed toolbox algorithms, against ocean model data. The study includes results from research into methods of calculation of mean dynamic topography and filtering methods presented at this workshop.",
    "full_text": "The GOCE User Toolbox Specification (GUTS) project has identified the key user requirements for a toolbox to aid the widest scientific community to use the expected data products from GOCE. These requirements are outlined in another paper at this workshop [1]. This, second, part of the project has identified the necessary functionality to provide a practical toolbox. In the selection of functions and algorithms, higher priority has been given to the oceanographic community requirements, as they have less expertise and previous experience is using the type of gravity and geoid products that will be produced by the GOCE mission. In the selection, we have also taken a pragmatic approach, ensuring that the functionality is achievable in a widely usable toolbox. This has involved rejecting some desirable functionality and output as being impractical or belonging to an area of active research. In the following paper, we will introduce the proposed main workflow of the toolbox that will provide solutions for the geodetic, solid earth and oceanographic communities. The scientific trade-off study has focused on the different filtering methods necessary to merge geodetic and satellite altimetric data to produce dynamic topography fields. The effect of different filters on the accuracy of the solution is studied along with the computational cost and the cost of implementation of the filters. Other factors in evaluating different filters include their general applicability and their priority, based on known qualities of the individual filter.\n\nThe primary workflow, defining the essential functionality of the proposed toolbox, is given in Fig. 1. This primary workflow will be expanded to allow the broader functionality expected of the actual toolbox. However, this workflow shows the key outputs: the geodetic, gravity and oceanographic fields to be calculated from the GOCE level 2 products and typical products from satellite altimetry. For the geodetic and solid earth communities, the primary products will be from the first line of the workflow: the geoid and gravity computations, complete with their associated error fields.\n\nWhen determining dynamic topography from a combination of geoid and sea surface height (SSH) data, it is important to ensure that the scales of information in the two source fields are compatible. In most cases the SSH data will contain information at higher spatial resolution than is included in the geoid model. These short scale features will contain both dynamic topography and geoid features and must be removed, by filtering, to provide a dynamic topography field that is consistent with the geoid field. In this study, we have investigated the most appropriate ways of carrying out this filtering.\n\nFirst let us introduce some terminology: The dynamic topography η D (mean or instantaneous) is the difference between altimetric SSH, h (mean or instantaneous), and geoid height, N D (both wrt a reference ellipsoid) so that:\n\nThe index D stands for data (observations). Because h and N D do not contain the same spatial scales we have to introduce the (linear) filter (matrix) F T :\n\nEq. 2 comprises the first method (the direct method) of obtaining a dynamic topography η.\n\nThe second method, the Remove-Restore (RR) method, is based on adding a correction to a prior guess of the dynamic topography η B , where the index B stands for the prior background. This background can be a highresolution ocean model dynamic topography. From this we construct a synthetic (background) geoid by\n\nThe RR-method then adds a (filtered) residual to the background value:\n\nDepending on the quality of the prior dynamic topography η B we expect the RR-method to perform better than direct filtering, as additional independent information is used. Using the field h -N D as prior η B results (correctly) in no filtering at all. Note that RR is still not optimal as no information about the accuracy of either measurements or prior guess enter the algorithm.\n\nIn this study we differentiate between three types of filters:\n\ngeographical space filters: These filters involve a kernel K x, ! x ( ) that is convoluted with the original field ! D \" x ( ) to give the filtered field\n\nkernel functions are available, among them a spherical cap, a rectangular cap, a Gaussian or quasi-Gaussian cap, Hanning and Hamming windows. spectral space filters: Here the field ! D is transformed into coefficients of a suitable expansion; here only spherical harmonic functions Y n x ( ) of degree and order n = l, m\n\n( ) are considered. The spectral expansion s n ! D ( ) is then modified according to the filter kernel K n and the filtered field is h x\n\n. The most popular kernel functions are the Pellinen filter (equivalent to a spherical cap in geographical space), a quasi-Gaussian filter (the exact transform of the quasi-Gaussian in geographical space [2]), and a simple boxcar filter (Dirichlet window). The latter has undesirable properties in the geographical space domain.\n\noptimal filters: Optimal interpolation or collocation techniques are used to find the filter kernel as the solution of minimizing an objective function of the type\n\nThis solution is the average between the original field and a prior estimate ! B weighted by the inverses of the error covariances C D / B associated with the input fields:\n\nBoth C B !1 and ! B can be zero, resulting in different properties of the solution.\n\nWhen these linear filters are applied to the full fields directly, we will refer to the method as direct filtering.\n\nAll three filter types, geographical (grid-) space, spectral space and optimal filters, can be used as either direct filters or with the RR method.\n\nIn the case of filtering dynamics topographies, these are the criteria that are used to evaluate a filter:\n\n• accuracy: distance from a reference solution, formal error description (with or without omission error) and comparison with reference data • universality: can you use the filter on irregular grids, individual point pairs, etc. • computational cost: CPU time and memory requirements (dependant on the filter implementation).\n\n• cost of implementation: we can only roughly estimate that, e.g. this filter is simple to implement, this filter is available as a prototype, etc ... • simplicity: in terms of usage, how many parameters need to be specified, e.g., just the maximum degree of cut-off or a full error covariance matrix. • necessity of having the filter Technically speaking, we construct a benchmark system which is simple enough that all filters can be run within it and complicated enough that it represents enough features of a real ocean dynamic topography problem.\n\nHere we have the choice of using \"real\" data, or purely synthetic data; that is, numerical model results modified to represent geoid and altimetry data. The advantage, and disadvantage, of the former is that we are immediately faced with all the difficulties that one normally has with real data and can take these difficulties into account while evaluating the filters. Using synthetic data in identical twin experiments enables us to know the results a priori and we can control the biases. We choose the latter approach.\n\nFor any filtering method, the filtered field should be associated with an error estimate, that is computed in a way consistent with the errors of the original fields and/or prior guesses. In principle this can be achieved by filtering the error co-variances C D associated with the input field ! D :\n\nTo take this a step further, the filtering result itself should implicitly include the prior error estimates. Only the optimal filters do that in a straightforward way (see above). For the optimal filter the posterior error can also be computed rigorously as\n\n, in principle. In practice, both the optimal filter and its error estimate is computational extraordinarily expensive and approximate methods may be used. Also, reliable estimates of the prior errors C B are not available. Although this method is \"optimal\", finding efficient and accurate filters based on this approach is the subject of research and can only be considered as a future part of the GOCE User Toolbox.\n\nIn constructing a (spectral) geoid model, one truncates the spectrum at a certain degree L, usually where the signal to noise ratio exceeds unity. For all degrees (and orders) ≤ L one has the coefficients of the model along with their error co-variances (the commission error) from the collocation process. The signal for degrees > L is not modelled, but it is identified as the omitted signal or omission error. Different models exist for the omission error, but they all assume a finite omission error, although it can be large depending on the cut-off degree L. The omission error generally poses no problem when one wishes to construct a dynamic topography from SSH minus geoid model, except that the scales that are suppressed by the chosen filtering algorithm become \"omission\". Also, for the case of SSH and geoid model, the represented scales are slightly different (especially at low resolution), because these fields are usually computed with different \"basis\" functions (grid vs. spherical harmonic functions). However, the spectra of both geoid height and SSH are red, so that these errors are probably negligible.\n\nFor computing the errors associated with a filtered mean dynamic topography, the omission error may become an issue that needs to be dealt with. Usually, the geoid model has a lower resolution than the SSH, so the geoid omission error is larger (reaches to larger scales). The error spectrum of geoid models is blue, i.e. errors are very small for small degrees and orders of magnitude larger for degrees near the cut-off degree L. For degrees > L the error is omission error and tapers off according to the chosen omission error model. Reference [3] have shown that a considerable portion of the omission error can leak into the commission error of the filtered signal, if the involved transformation involves dramatically different basis functions (Legendre function vs. trigonometric functions, spherical harmonics on the sphere vs. eigen functions of the error covariance along a hydrographic section).\n\nWith this machinery, we choose a η T to be the \"truth\" and a high-resolution \"true\" geoid N T that also represents the background geoid N B over the ocean. N T does not have to be very accurate on the short scales, so the EGM96 [4] (L = 360) is sufficient. The \"true\" dynamic topography is a mean from a ¼˚ ocean model with data assimilation (OCCAM, Ocean Circulation and Climate Advanced Modelling Project [5,6]). The background dynamic topography is taken from a different ocean model with data assimilation (ECCO [7]) to take into account possible errors and biases of the RR-method. From Eq. 1 we estimate the altimetric measurement h = ! T + N T . To generate an \"observed\" geoid we remove short scales from N T by applying an appropriate filter G, N D = G T N T . The measure of accuracy of the filter F is expressed as: )   for the direct method (Eq. 2) and the RR technique (Eq. 3), respectively. || • || is an appropriate L2-norm, for example the root-mean-square (rms). For the RR technique, one needs to take into account the error of the prior or background dynamic topography η B . These errors can be substantial. As an example, we compare the mean dynamic topography η B of the ECCO2 product and the \"truth\" η T of the OCCAM product. The mean dynamic topographies differ by as much a 1 m in the regions of strong topographic gradients, that is, strong surface currents (see Fig. 2). The rms-difference is 11 cm.\n\nComputational cost is estimated based on the used Matlab-code, which is designed for small problems, so that execution time can be favoured over memory requirements. For large problems the algorithms may have to be modified in order to reduce memory requirements at the cost of computational speed. On the other hand, the algorithms used for the geographical filters leave some room for optimization for speed.\n\nFiltering the error covariance, when provided, is very expensive and time consuming. Therefore, we use an even coarser resolution (4˚, corresponding to 445 km) to test the effect of the omission error on the resulting filtered errors, bearing in mind that the issues with the omission error may increase with decreasing resolution.\n\nFor geographical space filters it is important that the resulting errors are computed over the ocean only. For the spectral space filters the omission error of the geoid is effectively suppressed a priori, if the filter scale is larger than scales associated with the cut-off degree L.\n\nThe total error covariance of the dynamic topography is the sum of the commission error covariance C L , the omission error C om and the error of the SSH C SSH . C SSH is taken to be diagonal for simplicity, assuming a constant error of 5 cm. One could introduce horizontal correlations, but for the current application with a maximum resolution of 445 km we consider the SSH error uncorrelated. For the geoid model we use a preliminary error covariance of the CHAMP mission [8], which is available to degree and order 60, corresponding to 335 km half-wavelength, so that our 4˚ grid can just not resolve the full geoid errors. We can equally well use a covariance model such as that of [9]. We choose a commission cut-off of L = 20, corresponding to 1008 km half-wavelength, which can be resolved by the 4˚ grid. Error information on degrees L + 1 to 180/4=45 is then considered \"omission\" error, because our low-resolution geoid is truncated at L, but the computational ocean model grid resolves degree 45. This \"omission\" error has a cumulative degree variance corresponding to 13 cm. For a realistic case with an expected resolution of GOCE of L = 200 corresponding to 100 km half wavelength, the target resolution of an ocean model could be ¼˚, which corresponds to L = 720. The omission error from l = 201 to 720 can contribute to large scales mainly because its cumulative variance is on the order of 20 cm. In our approach we neglect all omission error beyond the resolution of the computational grid. This error, which is still large, could be taken into account by evaluating the omission error on an even higher resolution grid and averaging it onto the target resolution. However, we assume, somewhat optimistically, that the omission errors of the geoid model and the errors due to grid resolution cancel. Now we consider two cases: inclusion and exclusion of the omission error before filtering according to Eq. 5. If the filters remove short scales efficiently, the omission error should have little effect on the solution. However, if including the omission error results in larger errors, in particular of large-scale quantities such as the global mean dynamics topography error, leakage from short geoid scales to large geographical scales is a problem and needs to be addressed. For the geographical space filters, leakage stems from evaluating the geoid model over the ocean only by applying a realistic land mask to the filter. For spectral space filters the omission error of the geoid can be filtered efficiently (in principle by a box car filter, which unfortunately has bad properties in geographical space), but in order to apply a spectral space filter, the SSH error needs to be transformed into spectral space according to: C\n\nand here again the land mask may cause leakage.\n\nTable 1 summarizes the trade-off study. In general, spectral space filters are much faster (factor 16 in our case) than grid-space filters, because the latter involve as many convolutions with the filter kernel as there are grid points, whereas the former involves only one. With increasing resolution, this difference in efficiency may increase. All filters are simple to implement. Optimization for speed may require more sophistication.\n\nThe general advantage of the grid-space filters is that they are universally applicable, while the spectral space filters strictly speaking can only be applied to truly global fields. For computing regional fields spectral space filters may be inefficient, because they still require filtering a global field. Also it is not intuitive why local features should have a global effect, as they do with spectral space filters with insufficient resolution.\n\nThe difference between the constructed \"altimetric\" SSH, h, and the \"observed\" geoid, N D = G T N T , is shown in Fig. 3. This \"raw dynamic topography\" has many short scale features near coasts and steep topographic gradients, where the filter G has removed the short scales from the geoid, but not from the altimeter signal.\n\nFig. 4 summarizes the filter performance in terms of rms-difference (Eq. 5). The Gaussian and quasi-Gaussian filters lead to the smallest rms-differences. As expected, the filter with the Dirichlet-window in spectral space is the worst in terms of rms-difference.\n\nAs an example, Fig. 5 shows the dynamic topography of Fig. 3 after filtering with a quasi-Gaussian [2] filter. The figure contains the results of 4 different methods: Direct filtering (top) and the RR method (bottom) each with a geographical (grid-) space filter (left), a spectral (spherical harmonics) space filter (right). With the RR technique the resulting dynamic topographies contain more small scales (bottom panels) than with the direct method.\n\nThere appears to be an advantage with using a spectral space filter in the representation of marginal and shelf seas, such as the Hudson Bay or the Mediterranean Sea where the \"raw\" signal is very much depressed. The grid space filters, due to the lack of information over land, cannot reduce this depression, whereas the spectral space filters by construction use (false) geoid information over land and thus can better correct this problem.  The quasi-Gaussian filter appears to be more efficient in removing short scales associated with topographic features than the spherical cap/Pellinen filters, which is reflected in a smaller rms-difference to the truth (Fig. 4). However, these features are completely associated with the prior dynamic topography η B and may contain large errors.\n\nFor brevity, we consider the effects of the omission error mainly by the example of the quasi-Gaussian (Jekeli) filter. From Fig. 6 it is clear that the spectral space filter reduces the estimated errors more efficiently than the grid-space filter. In the present example the effects of the omission error are small (two orders of magnitude smaller than the error signal) for the spectral space filter, but not negligible for the grid-space filter (Fig. 7). In the latter case the magnitude of the omission error effect is about factor 6 smaller than the error signal. As an example for a large scale feature of the dynamics topography, where all short scale effects, and thus the omission error, is expected to drop out, the error of global mean of the dynamic topography is estimated (Fig. 8). While the mean error is small (and irrelevant for any dynamical considerations), including the omission error increases the mean error by approximately 10% in the case of the grid-space filters.\n\nThe spectral space filter leads to even smaller errors and they can effectively suppress any omission error effect (by construction). Fig. 4: Comparison of rms-difference between filtered fields and \"truth\". Top for the default cut-off degree L=25, bottom for a higher cut-off degree of L=45.\n\nFig. 5: Dynamic topography of Fig. 4 after filtering with a quasi-Gaussian (Jekeli) filter. Top: direct method, bottom: RR-method, left: grid-space filter, right: spectral (spherical harmonics) space. The colour bar is the same as in Fig. 4.\n\nIn this section we evaluate the results and give a rough recommendation for choosing an appropriate filter. In our testbed examples, the RR technique emerges as superior to the direct filtering method, because it yields the smallest overall rms-differences to the \"truth\" (not the prior dynamic topography). The requirement of a prior dynamic topography is not regarded as a restriction, as long as such a prior guess is provided as an integral part of the toolbox along with a simple method to replace the default prior guess with one provided by the user. However, estimating the error of this prior guess remains a difficult issue.\n\nMany filter kernels of this study perform reasonably well in smoothing the unfiltered difference between SSH and observed geoid. Based on the global rmsdifference between the filtered topography and the truth, the simplest filters, that is the grid-space rectangular (lat-lon) cap, spherical cap, and the spectral space boxcar (Dirichlet-window) filter are not recommended. These grid-space filters have a spectral response with negative side lobes and a boxcar filter in spectral space leads to Gibbs fringes in geographical space.\n\nOn the other hand, grid-space filters with a shape that resembles the Gaussian bell curve, such as the quasi-Gaussian kernel [2], a true Gaussian kernel, and the Hanning and Hamming type windows give the smallest rms-difference between filtered dynamic topography and \"truth\".\n\nThe spectral versions of the quasi-Gaussian and spherical cap (Pellinen) filters also give small rmsdifferences. These small differences to the \"truth\" can be attributed to the good representation of enclosed seas, such as Hudson Bay and the Mediterranean Sea. Filtering of the geoid, which is implicit in the spectral representation of any geoid model, leads to a removal of short scales. However, these scales are present in the SSH data so that the dynamic topography is grossly wrong. In the case of enclosed seas, or near coastlines where the geoid gradients are large (e.g., along South America's West coast), where grid-space filters fail due to the lack of information on the true geoid gradients, the originally undesired property of a spectral space filter, namely that it uses information of an undefined and therefore arbitrary \"sea surface over land\", tends to"
}
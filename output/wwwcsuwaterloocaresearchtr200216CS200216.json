{
    "title": "Simulating the Dynamics of the Dancing Lights",
    "publication_date": "2002-04",
    "authors": [
        {
            "full_name": "Gladimir Baranoski",
            "firstname": "Gladimir",
            "lastname": "Baranoski",
            "affiliations": [
                {
                    "organization": "Department of Computer Science, University of Waterloo",
                    "address": {
                        "country": "Canada"
                    }
                }
            ]
        },
        {
            "full_name": "Justin Wan",
            "firstname": "Justin",
            "lastname": "Wan",
            "affiliations": [
                {
                    "organization": "Department of Computer Science, University of Waterloo",
                    "address": {
                        "country": "Canada"
                    }
                }
            ]
        },
        {
            "full_name": "Jon Rokne",
            "firstname": "Jon",
            "lastname": "Rokne",
            "affiliations": [
                {
                    "organization": "Department of Computer Science, University of Waterloo",
                    "address": {
                        "country": "Canada"
                    }
                }
            ]
        },
        {
            "full_name": "Ian Bell",
            "firstname": "Ian",
            "lastname": "Bell",
            "affiliations": [
                {
                    "organization": "Department of Computer Science, University of Waterloo",
                    "address": {
                        "country": "Canada"
                    }
                }
            ]
        }
    ],
    "abstract": "Figure 1: Frames from an animation illustrating an auroral surge (spiral) formation in the northern hemisphere.",
    "full_text": "The Aurora Borealis, or \"Northern Lights\", and Aurora Australis, its southern counterpart, are light emissions caused by the collision of an ionized stream of charged particles with high altitude atmospheric atoms and molecules [15]. These phenomena are considered by many to be the most fascinating and mysterious of Nature's spectacles. Taylor in National Geographic called them \"Earth's Grand Show of Lights\" [43]. An inherent characteristic of auroral displays is that they move and change shape slowly or rapidly. These complex and stochastic motions are directly related to the plasma processes. In this paper a novel physically-based model to perform 3D visual simulations of the dynamics of the auroral phenomena is presented. Furthermore, auroral surges (Figure 1), which have not been previously simulated, are also rendered using this model.\n\nRecently, Jensen et al. [28] developed a physically-based model of the night sky. Although their model does not include auroral displays, their night sky images can be combined with our auroral simulations. They also highlighted the role of naturally illuminated night scenes in the history of image making and their importance in the area of realistic rendering.\n\nBaranoski et al. [2] presented a physically-based algorithm for the rendering of auroral displays which accounts for important auroral visual features such as their characteristic spectral and intensity variation. Their work, however, does not take into account the electro-magnetic instabilities responsible for the time varying behavior of the auroras. Although their algorithm cannot be used to realistically simulate auroral dynamics, which involves a wide range of spatio-temporal scales, it provides an accurate framework for the rendering of auroral images.\n\nThe spectacular auroral motions and shape changes involve to some extent shear, i.e., differential motions within different parts of a fluid or gaseous material. Shear is common in nature. Shear eddies show on the surface of water in streams, or beside boats moving through water, in smoke curling up from a fire and they are also responsible for clear-air turbulence and gusty winds. Shear found in the auroras is associated with plasma processes, whose most fascinating consequences are the formation of rotational distortions having different spatio-temporal scales [13].\n\nSeveral papers in the computer graphics literature have addressed the simulation of natural phenomena involving shear and fluid flow [17,20,19,30,33,41,40]. Although the plasma instability responsible for the stochastic and complex nature of the auroras is similar to the Kelvin-Helmholtz instability (KHI) of sheared fluids [42], a more natural way to model auroral phenomena is to simulate the equations of plasma flow directly. The use of a plasma model allows the control of the simulations by auroral physically meaningful parameters. Moreover, it enables the accurate reproduction of rapid intermediate scale motions often seen in the auroras such as the motion of rays and folds along auroral forms.\n\nThe simulation of plasma instabilities as well as fluid instabilities involves the solution of systems of partial differential equations (PDEs). The production of animation sequences require the solution of such systems many times. Usually standard iterative methods, such as the Conjugate Gradient (CG) and Fast Fourier Transform (FFT) [21], are applied. Stam [39,40] has highlighted the theoretical advantages of the application of multigrid methods [22] to solve such systems. In this paper we introduce a practical and fast multigrid algorithm suitable to solve PDEs arising from plasma and fluid flow simulations. We note that our multigrid implementation is matrix-free, i.e., it does store coarse grid quantities. Previous multigrid implementations found in the computer graphics literature, such as the one used by Witkin and Kass in the their texture synthesis algorithm [48], do not address this issue.\n\nThe remainder of this paper is organized as follows. The next section provides an overview of relevant auroral physics concepts and describes the main motions and shape changes of the auroras. Section 3 outlines the modeling framework used in this research. Section 4 presents the algorithms used to simulate the dynamics of the auroral phenomena. Section 5 addresses rendering issues. Section 6 presents the results of our simulations and discusses performance issues. Finally, Section 7 concludes this paper providing directions for future work.\n\nIn this section we outline the main physical aspects directly related to the simulation of auroral dynamics. A reader interested in a de- tailed description of auroral physics is referred to more comprehensive texts on these phenomena [7,13,15,29,36]. The diagrams of auroral distortions presented in this section use as reference an auroral local coordinate system represented by xyz, where the z-axis corresponds to the direction parallel to the Earth's magnetic field vector ¡ .\n\nThe particles responsible for the colorful auroral displays are electrons that originate from solar flares and coronal mass ejections and become the \"solar wind\" [9]. After interacting with the Earth's magnetosphere, these particles migrate along the magnetic field lines, and eventually \"dive\" towards oval regions around the Earth's magnetic poles. These regions are called auroral ovals (Figure 2). The shape of an aurora is determined by the energy and density of the electrons entering the atmosphere, as well as the local variations in the Earth's magnetic and electric fields. The most common aurora can be thought of as a \"curtain\" of light emissions from \"sheets\" of falling electrons, which move in parallel with the Earth's magnetic field.\n\nAs the electrons travel down along the Earth's magnetic field lines they suffer many random deflections which are caused by collisions with atoms of atmospheric gases such as oxygen and nitrogen. These deflections spread the electrons out horizontally. When the electrons collide with atmospheric constituents, the atoms are excited and after a period of time they may emit a photon. Statistically several collisions must occur before a photon is emitted. As a result of these photon emissions the curtains will be colored, brightly yellow-green at the bottom, perhaps red at the top, and a yellow/orange transition may also be present. Oftentimes they can form arcs that can extend over ¢ ¤£ ¥£ ¦£ ¨ § © whose width (thickness) may vary from several hundred meters to several kilometers. These arcs can bend and fold almost like real curtains thereby generating bright vertical streaks.\n\nThe sheets of precipitating electrons form an auroral stream that is subject to instabilities responsible for the shear-type rotational distortions seen in auroral arcs. Hallinan and Davis [26] identified the three distinct types of distortions: curls, folds and spirals (Figure 3). Curls are small scale and have a diameter of 1 § © or less. Folds are intermediate scale distortions and have a diameter of approximately 20 § © or less. Spirals, or surges, are the largest auroral vortices and diameters typically around 20-1300 § © [38]. In addition to the different spatial scales, these phenomena have also different temporal scales. Curls have a lifetime of a fraction of a second, while folds can exist for more than a second and spirals may last minutes. Curls and folds are responsible for distinct visual features present in auroral displays. The light emanating from convoluted folds in auroral displays oftentimes creates the impression of vertical, or near-vertical, \"stripes\" [8]. Despite their highly transient nature, curls are largely responsible for another important auroral feature, namely electron beams evolving into thin field-aligned filaments or \"rays\". An auroral ray typically has a vertical dimension up to several hundred kilometers. Curls are usually 2-10 § © apart, while folds are approximately 20 § © apart. Spirals are also relative common auroral structures, visible in more than 30% of the Defense Meteorological Satellite Program observations 1 [14]. They can form a street of two or more spirals approximately 100 § © apart. The spirals in the street usually have similar configuration and size, but they may also grow monotonically along the auroral display [14].\n\nAs pointed out by Davis [13], auroral motions and shape changes seem bewildering, yet they present some order when examined in detail. Many of the motions and shape changes associated with the auroral distortions are caused by warping of the incoming particle streams by attendant magnetic and electric fields. In this section we outline the most important of these changes according to their spatial scale.\n\nWhen an electron particle stream responsible for producing such structure becomes slightly more dense in a region, it is likely to become contorted and a curl develops [13]. The curl formation process is similar to the spiral formation process and leading to essentially the same final configuration. However, the entire curl formation can occur so rapidly (0.25-0.75 [44]) that an observer on the ground has difficulty in following the process.\n\nOnce a curl vortex develops, it tends to cause the formation of another curl a short distance along the arc. The net result is the development of an array of evenly spaced auroral rays along the arc. If another arc is nearby, the rays come under the influence of its electrical field and therefore move along the arc [13]. If the process that leads to curl formation continues a bit longer, then small, uniformly spaced folds occur, and sometimes the arc even splits into two separate arcs as the folds break apart (Figure 4). Folds have apparent horizontal velocities in the range of 0-5 § © ¡ [26]. The apparent horizontal velocities of curls lie in the range of 0-90 § © ¡\n\n, with preferred speeds in the range of 0-8 § © ¡ [44]. To have a better idea of the magnitude of these speeds, the reader has to recall that an auroral arc may extend over the entire field of view of an observer on the ground. For this observer the auroral rays will \"travel\" back and forth between two extreme points in the horizon in few seconds.\n\nWhen an incoming stream of electrons that produces an auroral arc develops a slight irregularity, the irregularity can grow [23,24,32,37]. As it does, the stream becomes distorted, carrying incoming particles to new locations in the auroral atmosphere [13]. The growth of this irregularity depends on the thickness of the electron stream. The larger the stream length to thickness ratio, the faster the irregularity grows with the distance [23,32]. Figure 5 shows an auroral arc being affected by the warping process, first developing a fold and then progressing into a complex spiral shape.\n\nThese large auroral vortices have an average speed of ¢ § © ¡ [38].\n\nEven if an aurora underwent no changes, an observer on the ground would see apparent motions due to the Earth's motion beneath the auroral ovals. The interactions of solar wind particles with the Earth's magnetosphere also result in a westward or eastward drifting of auroral forms (speeds up to £ £ § © ¡ can be observed [35]). When the level of auroral activity increases, the diameter of the auroral ovals increase and the ovals widen. These changes cause an observer to see north-south motions (typical speeds of £ £ ¦£ ¥¤ ¢ £ ¥£ © ¡ [16], £ § © ¡ can also be observed [36]). The intensity variations of the auroras are usually a function of where in the magnetic substorm (large variations in the magnetic field [31]) cycle they occur. This cycle consists of a quiet phase, a growth phase (up to 2 hours), an active expansion phase (approximately ¢ £ minutes) and a recovery phase (30 minutes to 2 hours) [6]. The highest intensity variations, often associated with the formation of spiral streets, occur during the expansion phase (Figure 2).\n\nComputer modeling of plasma can be broadly divided in two types: Eulerian and Lagrangian [27]. The Eulerian model assumes plasma to behave like a fluid or to obey macroscopic differential equations for average quantities. The Lagrangian model follows the motion of a large number of particles as they move in time under their mutual electromagnetic interactions. Although this model acts on the microscopic particle level, it allows the particle ensemble to \"make its own mind\" about its macroscopic and collective behavior. This aspect is relevant in the simulation of phenomena with noticeable stochastic traits and different spatio-temporal scales such as auroras.\n\nWe use an hybrid Eulerian-Lagrangian approach in our modeling of auroral phenomena. In order to minimize computational overhead we follow the path of beams of electrons instead of tracking £ £ ¢¡ individual plasma particles provided by Nature. As such, we use normalized values for the physical quantities involved in our simulations, namely charge, mass and permissivity. The Lagrangian treatment is used to account for the interactions among beams and between beams and atmospheric constituents. The Eulerian treatment is applied when spatial scales much greater than the relatively small amplitude motions of the beams are considered.\n\nThe motion of electron beams has two components: parallel and perpendicular to the electron stream. The parallel component is associated with the kinetic energy of the incoming particles. The perpendicular component is due to the warping of the electron stream.\n\nThe key stage of our modeling framework is the simulation of this time dependent process, which changes the perpendicular velocity, £ ¥¤ , and the position of electron beams, ¦ , at the top of the electron stream at each instance of time. The mathematics of this warping process can be described by an electro-magnetic version of KHI [23,24,32,37]. Section 4 describes in detail the warping algorithm used in our simulations.\n\nThe position of each beam at the top of the electron stream is considered as the starting point of its descending trajectory. The position update resulting from the warping process is associated with a steady state of incoming particles. A precipitating electron beam is tracked down until it becomes indistinguishable from the ambient electron population. During their descending trajectories the electron beams may be deflected several times due to collisions with atmospheric constituents. Light emissions may occur at these deflection points causing the auroral displays. These emissions are mapped to the screen plane of a virtual camera using a splatting approach [47] described in Section 5.\n\nThe auroral dynamics simulation uses the auroral local coordinate system previously defined (Section 2). The mapping of auroral emissions uses as reference a global coordinate system represented by XYZ, where the Y-axis corresponds to the direction normal to the ground.\n\nThe electron beams interact with one another through the electric field, § , generated by their mutual electrostatic repulsion, and the Earth's magnetic field, ¡ . Thus, the Lorentz force on an electron beam © with charge © moving with a perpendicular velocity £ ¤\n\n(2) Thus, to update the positions of the electron beams, we need to compute § and ¡ . In the auroral warping simulation, the Earth's magnetic field is modeled as an uniform magnetic field of strength\n\n¡ . At any instance of time, the electron beams and hence § are located in the plane perpendicular to ¡ . By Gauss' law, § satisfies 4 65 § 87 9 A@ %\n\nwhere 9 &@ is the permissivity of free space, and\n\nis the charge density function\n\nHere we model the small mass, low density electron beams with charge © at the position (5) By solving equations ( 2) and ( 5) over time, we can model the perpendicular motion of electron beams, which is the crucial aspect of the auroral dynamics.\n\nThe potential equation ( 5) and the electron beam velocity equations (2) form a coupled continuous-particle system, which is simulated using the particle-mesh method exploiting the force-at-a-point formulation and a field equation for the potential. For the former, we use a Lagrangian grid approach whereas for the latter, we use an Eulerian approach. The perpendicular velocities and positions of the electron beams are advanced in time as follows:\n\n(1) from the positions of electron beams, a charge distribution is derived;\n\n(2) from the charge distribution, using Poisson equation, the electrostatic potential is calculated;\n\n(3) from the potential, the electric field acting on each electron beam is derived;\n\n(4) Newton's law of motion using the local electron field and the Earth's magnetic field is then integrated.\n\nThis calculation gives a new position and velocity for each electron beam, and the cycle repeats at step (1). The aurora dynamics initiates from incoming sheets of particles at the auroral oval (Figure 2) forming an auroral stream, which is modeled by a strip of incoming electron beams with periodic boundary conditions in the x-axis (Figure 6). As an initial condition, the electron beams are distributed randomly in the interior of this strip of thickness P and length Q , and have zero perpendicular velocity. Faster initial growth of auroral distortions will occur for a larger value of the Q /P ratio.\n\nIn the hybrid Eulerian-Lagrangian formulation, the field and particle quantities are defined on different grids. To obtain the charge density at mesh points from the distribution of particles, we allocate the particle charges based on the CIC (cloud-in-cell) [3] charge assignment scheme: the charge density 7 ¢¡ £ at the grid point ¤ ¦¥ §¡ £ ©¨i s given by the sum of weighted charges, © © , of the electron beams ¨© in the cells surrounding the grid point ¤ ¥ §¡ £ ©¨d ivided by the cell area:\n\nas indicated in Figure 7(a). However, instead of finding which electron beams contribute the charge to the grid point ¤ ¥ §¡ £ ©¨, we sweep through each electron beam and distribute its charge with weights\n\n£ &% , to the vertices of the grid cell it belongs to; as indicated in Figure 7b. To be consistent with the definition of the continuous charge density (4), the weight\n\nmust be given by\n\nwhere ( 0 5 # is a modified Dirac delta function with compact support parameterized by 9 , which has the property that\n\n3 54 76 0 98 @ ( 10 & 5 # G 3 5 # &%\n\nin the sense of distribution. It can be interpreted physically by ascribing a finite width ( 9) to the distribution of charge in each particle. In the CIC scheme, ( 0 is given by the hat-shape function [3].\n\nThe gradient of the potential function satisfies the following equation:\n\nH is the Laplacian of the potential. On an Eulerian grid with mesh size @ , the partial differential equation can be discretized as\n\n§¡ £ 9 A@ % which leads to a set of linear equations, denoted by D \"E 7 where E is a vector of unknown potentials and 7 is a vector of (scaled) charge densities. The matrix D is large, sparse, symmetric and positive definite. The complexity of most matrix solvers depends on the size of D . For the simulation of auroral dynamics, especially the formation of surges, a fine grid is required to resolve the layer structure. Thus, an efficient linear solver is indispensable.\n\nDirect methods, such as banded Gaussian elimination (GE), can be used to exploit the banded structure of D . For matrices of size\n\nwhich is computationally impractical. Iterative methods, such as preconditioned conjugate gradient (PCG) with incomplete Cholesky factorization as preconditioner, have been used in computer graphics for fluid simulations [17,19]. While the theoretical complexity is reduced to\n\n, it is still too expensive for long time simulation. The FFT method [40] can improve the complexity further to G $ F 3 7Q SR ¡ F # but still it is not optimal.\n\nThe multigrid method is an optimal scheme in which the convergence rate is independent of the problem size. Thus, it has a linear complexity, as opposed to the methods above. It exploits the properties of the linear equations at the PDE level, rather than the matrix structure. It was first proposed by Fedorenko [18] in the 1960's, and made popular by Brandt [5] and others for scientific applications. We refer the interested reader to the survey paper by Chan and Wan [11] on recent developments of linear elliptic multigrid methods. Early attempts of using multigrid methods to solve a multiple scattering problem [39] raised the issue of memory due to storage of coarse grid quantities. Here, we introduce a matrix-free implementation which is extremely memory-efficient. We remark that similar multigrid schemes can also be used in fluid simulations.\n\nThe idea of multigrid method is to accelerate the convergence of iteration by solving the PDEs on a sequence of coarse grids. The basic principle is to eliminate high frequency errors by relaxation smoothing and low frequency errors by coarse grid correction. Let E UT be the current approximate solution on the fine grid with mesh size @ , and § T )E ¤ VE UT be its error. By the dissipative nature of Poisson equation, the error of the numerical solution, WE UT , obtained from a few relaxation steps, will become smooth. Thus, one can easily compute an accurate coarse grid approximation by projecting the residual error, X T 7 ¤ YD WE UT , onto the coarse grid with mesh size `and solving the coarse grid error equation where h T a\n\nis the linear interpolation operator. This process completes one multigrid V-cycle (Figure 8).\n\nWe note that only the actions of the coarse grid, interpolation and restriction operators are needed. Thus, we never form nor store these matrices. Consequently, only 3.5 fine grid vectors are needed in our implementation, which requires even less memory than CG.\n\nIn contrast to GE and PCG methods, the number of multigrid iterations to convergence is independent of the grid size. In practice, we observe that 1 to 2 multigrid V-cycles will be sufficient, compared to hundreds of PCG iterations. We address performance issues further in Section 6.\n\nThe electric field § §¡ £ is defined on the Eulerian grid whose value is given by numerical differentiation of H ¢¡ £ . However, electron beams are located on the Lagrangian grid which in general does not overlap with the former. Thus, the electric field on an electron beam © located at ¦ © is obtained by interpolating the electric fields at the nearest four corners, i.e., the reverse process of charge distribution as in Figure 7(b). Then, we update the perpendicular velocities and positions of the electron beams by integrating equation (2).\n\nThe electron beam's velocity vector, £ , is defined as the overall direction of progression during its descending motion. As the beams travel down they may suffer several random deflections. Their trajectories are simulated incrementally using the stochastic algorithm presented by Baranoski et al. [2]. This algorithm takes into account the spatial inhomogeneity of auroral electrons and their initial energy to compute the deflection points and the displacements of an electron beam along the magnetic field lines. Each path is simulated incrementally, using a parametric displacement\n\n( # where is an uniformly distributed random number in the interval ¡ £ ¥2 2 £ £ , and ( is a vertical displacement (resulting from collisions between auroral particles and atmospheric constituents) which is adjusted according to the initial energy of the incoming particles.\n\nAuroras are view dependent phenomena, i.e., the apparent surface brightness of an aurora is proportional to the integrated emission per unit volume along the line of sight (Figure 10). Hence, a forward mapping, or splatting, approach can be used to map auroral emissions to the screen plane [2,47]. Recall that after being hit by an electron, an atmospheric atom becomes excited and after a period of time it may emit a photon. Statistically, the intensity contribution spreads radially around the propagation direction, and follows a Gaussian distribution along that dimension [4]. In order to account for this phenomenon, we implemented an algorithm to perform a distributed forward mapping of auroral emissions. The world coordinates of each deflection point are used to compute the line of sight vector . This vector is randomly perturbed to generate a light emission ray X . This perturbation is performed through angular displacements and (Fig- ure 11). The angle represents the azimuthal angle around . The angle represents the polar angle with respect to , and it corre- sponds to the exponential glow decay observed in auroral arcs [4]. These angles are given by The number of emission rays, given by , affects both accuracy and performance. Experiments show, however, an asymptotic convergence of the results as larger values are assigned to .\n\nThe emissions mapped to the screen plane are scaled according to auroral spectral emission and intensity profiles [2], which correlate with the height of the emission point [7]. The conversion of auroral spectral emissions to a color space follows a straightforward CIE XYZ to RGB mapping procedure. We consider in our simulations the strongest auroral spectral emissions, namely 630.0 F © (red line), 557.7 F © (green line) and 427.8 F © (blue line). More wavelengths can be considered at the expense of higher computational time.\n\nThe different lifetime of transition states in auroral emissions cause distinct spread areas around the principal direction of photon emission -110s for the red line, 0.7s for the green line, and 0.001s for the blue line. In order to simulate this distribution of auroral emissions we convolve the image with a color-dependent Gaussian low-pass filter [2,47].\n\nAn auroral display also exhibits global temporal variations captured in photographs as blurred forms, due to finite exposure times. For simulating this global blurring effect we perform a convolution using a temporal low-pass filter [2,10]. The longer the sampledwindow is in time, the blurrier the results, similar to the effects captured in real photographs with longer exposure times.\n\nThe final stage of our rendering pipeline consists of blending the auroral display with a night sky background and a foreground. We use a composite approach in which we initialize the color buffer with the background scene, superimpose the auroral display, and finally filter out regions of the image that would be covered by foreground objects.\n\nIn  Although in our simulations we accounted for photographic blur, features readily recognizable by viewers in real auroras were preserved, e.g., presence of rayed structures and vertical distribution of intensity (Figure 13), as well as their characteristic spatio-temporal variations. This aspect was verified through comparisons with observations of the real phenomena, including the positive feedback from scientists working in the auroral imaging field [25,45]. Figures 1, 10 and 12 present still frames from animations produced using our model. For these animations we used a 1024x1024 mesh for the starting points, and varying values for the vertical displacement of the electron beams. The length and thickness of the initial auroral stream used in these simulations were 2000 § © and 9 § © respectively. The computations were performed on a SGI550 with dual 850¡ d@ £¢ Pentium3 processors. Figure 14 presents eight frames from an animation showing the motions and shape changes of an auroral rayed band. In this animation one can observe the rapid movement of auroral rays, the formation and motion of folds and a rotational distortion of the auroral band. In this simulation the number of electron beams considered was 4x10¤ , with a vertical displacement (Section 4.2) of 0.05. The time spent to compute the starting points and the descending trajectories for each time step was 2.6 and 10.8 respectively. The frames were rendered at a resolution of 320x240 pixels, and using 10 rays per emission point.\n\nFigure 15 presents two all-sky photographs taken during an auroral surge formation. Figure 16 presents eight frames from an animation illustrating the simulation of such natural phenomena. In this animation, besides the warping process leading to an auroral spiral, we can also notice the formation and motion of folds. In this simulation the number of electrons beams considered was 10¤ , with a vertical displacement of 0.2. The time spent to compute the starting points and the descending trajectories for each time step was 1.7 and 10.27 respectively. The frames were rendered at a resolution of 320x240 pixels, and using 20 rays per emission point.\n\nRecently, scientists using NASA's polar spacecraft have captured the first film of auroras dancing simultaneously around both magnetic polesfoot_1 . This film show the Aurora Borealis and Aurora Australis expanding and brightening in parallel at opposite ends of the Earth, confirming the three-century-old theory that auroras in the northern and southern hemisphere are nearly mirror images of each other. In the case of auroral spirals, the distinct feature is their opposite sense of rotation. Usually they are counterclockwise in the southern hemisphere when viewed from the ground, and clockwise in the northern hemisphere. Figure 1 presents four frames from an animation illustrating an auroral surge formation in the northern hemisphere at twice normal speed. In this simulation the number of electrons beams considered was 10¤ , with a vertical displacement of 0.1. The time spent to compute the starting points and the descending trajectories for each time step was 1.7 and 6 respectively. The frames were rendered at a resolution of 480x360 pixels, and using 5 rays per emission point.\n\nUsing the multigrid algorithm we were able to reduce substantially the time required in the warping computations. For instance, on the 1024x1024 auroral mesh used in our simulations, multigrid is 96 times faster than CG. Due to this reduction, the computation of the descending trajectories became the bottleneck of our simulation pipeline. A divide and conquer strategy can be applied, however, to decrease the total running time of these computations. In other words, one can process F trajectories separately in several processors. For instance, for £ £ P electron beams, Baranoski and Rokne obtained a speedup of 4.6 using five Compaq Alpha 500¡ @ £¢ PWS processors [1]. Nonetheless, we believe that there is still room for improvement on the parallelization of the algorithms.\n\nIn this paper we have presented a novel physically-based model for the 3D visual simulation of auroral dynamics. It allows an accurate and efficient visualization of auroral phenomena at different spatiotemporal scales. To the best of our knowledge, although static and KHI free auroral simulations have been performed [2], 3D dynamical auroral simulations have not previously appeared in the scientific literature.\n\nThe algorithms used in our hybrid plasma model can be incorporated into most animation frameworks. The fast and memoryefficient multigrid method used to solve the linear equations arising from our simulations can also be applied in the simulation of other natural phenomena such as gas, smoke or water flow.\n\nAs future work we plan to extend the application of the algorithms presented in this paper to other plasma related phenomena found in Nature. We also intend to continue to work on their parallelization, and to exploit graphics hardware for the real time simulation of moving auroral displays.\n\n¡Department of Computer Science, The University of Calgary.The auroras are frequently visible at high latitudes. They can also be seen less frequently at lower latitudes, especially during a solar maximum (a period of great solar turbulence that occurs approximately every 11 years[34]). The present solar cycle reached the maximum in the year 2000 and it is likely to produce amazingly bright auroras for the next couple of years. Auroras are also a strong visible effect in space, and even occur on planets with strong magnetic fields such as Jupiter and Saturn. Hence, the simulation of auroral displays is of interest for the production of night sky animation sequences used in film and planetarium shows. Moreover, the algorithms used in our plasma model may also be applied to the simulation of other plasma related phenomena, from gas discharges encountered in neon and fluorescent lights to gaseous nebulae and visual pulsars.On the scientific side, the importance of the visual simulation of auroral dynamics is related to its links to plasma physics. As much as 99.9 % of the matter in the universe is thought to exist in plasma state. The auroral displays provide a natural laboratory in which the complex workings of the plasma universe can be studied. Therefore, their simulation can be used in the evaluation of auroral theories as well as in the visualization of other astrophysics phenomena. For instance, plasma kinetic theory can be used to predict the development of galaxies, since, although stars in a galaxy are not charged, they behave like particles in a plasma[12].\n\nhttp://eiger.physics.uiowa.edu/¥ vis/conjugate aurora/"
}
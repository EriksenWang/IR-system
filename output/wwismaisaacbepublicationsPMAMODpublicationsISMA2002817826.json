{
    "title": "High performance implementation and conceptual development of the wave based method for steady-state dynamic analysis of acoustic problems",
    "publication_date": "1989",
    "authors": [
        {
            "full_name": "B Van Hal",
            "firstname": "B",
            "lastname": "Van Hal",
            "affiliations": []
        },
        {
            "full_name": "A Hepberger",
            "firstname": "A",
            "lastname": "Hepberger",
            "affiliations": [
                {
                    "organization": "ACC Acoustic Competence Center G.m.b.H",
                    "address": {
                        "city": "Graz",
                        "country": "Austria",
                        "postcode": "A-8010"
                    }
                }
            ]
        },
        {
            "full_name": "H.-H Priebsch",
            "firstname": "H.-H",
            "lastname": "Priebsch",
            "affiliations": [
                {
                    "organization": "ACC Acoustic Competence Center G.m.b.H",
                    "address": {
                        "city": "Graz",
                        "country": "Austria",
                        "postcode": "A-8010"
                    }
                }
            ]
        },
        {
            "full_name": "W Desmet",
            "firstname": "W",
            "lastname": "Desmet",
            "affiliations": []
        },
        {
            "full_name": "P Sas",
            "firstname": "P",
            "lastname": "Sas",
            "affiliations": []
        },
        {
            "full_name": "K U Leuven",
            "firstname": "K U",
            "lastname": "Leuven",
            "affiliations": []
        }
    ],
    "abstract": "The wave based method (WBM) is considered for the steady-state dynamic analysis of acoustic problems as an alternative for the finite element method (FEM). The WBM exhibits better convergence properties with respect to model sizes, but the computation (CPU) times obtained by the current MATLAB implementation are large compared to commercially available FEM codes. Recently, a high performance FORTRAN code has been developed, which becomes more efficient than the commercially available FEM codes, even with respect to the CPU times. Despite the good results presented in this paper, the conceptual development of the WBM still requires much attention. The following topics are discussed briefly: the domain decomposition, the extension of the expansion of basis functions, which forms the approximation solution, the boundary integration scheme and the coupling between the FEM and the WBM. The results of these investigation may improve the efficiency of the high performance FORTRAN implementation further.",
    "full_text": "The finite element method (FEM) is a widely accepted prediction tool for the steady-state dynamic analysis of acoustic problems [1], [2]. However, the FEM is practically limited to the low-frequency application range, since the computational costs increase for increasing frequency. Recently, an alternative deterministic method has been developed, namely the wave based method (WBM) [3], which is based on the TREFFTZ approach [4]. The WBM exhibits better convergence properties with respect to model sizes than the FEM. Therefore, the frequency application range of the deterministic methods can be extended towards the mid-frequency range.\n\nUntil recently, the WBM has only been implemented in a MATLAB code. This results in longer computation (CPU) times than commercially available software. In order to demonstrate the capability of the WBM to be more efficient than the FEM, also with respect to CPU times, a high performance implementation is required. A recently developed FOR-TRAN code is well suited for this purpose. After a brief discussion of the theoretical background of the WBM, this paper demonstrates that the high perfor-mance implementation of the WBM is more efficient for a 2-dimensional (2D) uncoupled acoustic benchmark problem than the commercially available finite element code SYSNOISE [5].\n\nDespite the good results presented in this paper, more research is required. The model sizes in the WBM are smaller than in the FEM, but the system matrices are no longer sparse. This may cause memory problems in the 3D case. Therefore, still much attention is given to the conceptual development of the method. This paper sheds some light on a few research topics. Most attention goes to the domain decomposition, which is required for the analysis of non-convex domains. Furthermore, the extension of the currently applied expansion of basis functions, which forms the approximation solution, the applied integration schemes and the coupling between the FEM and the WBM are discussed briefly.\n\nConsider the 2D uncoupled acoustic problem shown in figure 1. The acoustic domain Ω, surrounded by the boundary Γ, is excited by the cylindrical source q at position r q . The Helmholtz equation governs the steady-state pressure response, described by its complex amplitude p, at position r = (x, y)\n\nwhere ∆ = ∂ 2 /∂x 2 + ∂ 2 /∂y 2 represents the Laplace operator, k = ω/c the wave number with the radial excitation frequency ω and the speed of sound c, ρ the ambient density, δ the Dirac delta function and R = rr q the distance between the response point and excitation point. The boundary Γ is the union of the boundary Γ p with the prescribed pressure p, the boundary Γ v with the prescribed normal velocity vn and the boundary Γ Z with the prescribed normal impedance\n\nThe following relations describe the acoustic boundary conditions\n\nwhere ∂/∂n represents the derivative in the outward normal direction n.\n\nThe pressure field p is approximated by an expansion of n a wave functions Φ a extended by a particular so-\n\nFigure 1: 2D coupled acoustic problem lution function pq . The pressure approximation p is given by\n\nwhere p a represents the contribution of each wave function to the pressure approximation p. The wave contributions p a form the unknown degrees of freedom (DOF's) of the wave model. The wave functions Φ a and the wave contributions p a are stored, respectively, in the column vectors Φ and p. The T in (3) denotes the transpose operator. The set of wave functions Φ a is defined by\n\nThe above functions are homogeneous solutions of the governing Helmholtz equation. The free field pressure response to the cylindrical source q is selected as particular solution pq pq (r) = ρωq 4 H\n\n(2)\n\nwith the zero-order Hankel function of the second kind H\n\n(2) 0 .\n\nThe pressure approximation p satisfies a priori the governing Helmholtz equation ( 1), since it consists of a linear combination of homogeneous solutions extended by a particular solution. Therefore, the boundary conditions (2) determine the unknown wave contributions p a . The wave model is obtained by enforcing the pressure approximation p to satisfy the boundary conditions (2) in an integral sense. The above procedure is performed either by applying a weighted residual formulation or a least-squares formulation of the boundary conditions.\n\nIn the weighted residual formulation, the violation of the boundary conditions is averaged to zero using a weighing function p as follows\n\nwhere s represents the boundary coordinate in tangential direction s (see figure 1) and where R * represent the residual functions defined as\n\nBy using each wave function Φ a as a weighing function p, n a linear equations are obtained, which form the following wave model\n\nwith the system matrix A (W R) defined as\n\nand with the system vector b (W R) defined as\n\nIn the least-squares formulation, the violation of the boundary conditions is minimized along the boundary Γ. The following error functional\n\nwhich is a measure for the approximation error, is minimized with respect to the wave contributions p a . This results in n a linear equations of the following wave model\n\nwith the system matrix A (LS) defined as\n\nand with the system vector b (LS) defined as b (LS) = ...\n\nwhere c denotes the complex conjugate operator. The parameters α v and α p in (11) restore the homogeneity between the different components of the error functional F. In the numerical experiments α p = 1 and α v = (ρc) 2 are used.\n\nThe wave models, discussed here, exhibit the following properties. The system matrices A (W R) and A (LS) are\n\n• small compared to finite element models,\n\n• fully populated and complex,\n\n• implicitly dependent on frequency and\n\n• symmetric and Hermitian, respectively.\n\nThe consequence of the implicit frequency dependency of the system matrices is that they cannot be assembled from frequency independent matrices as in the FEM. This feature disables the application of a modal superposition strategy.\n\nIn order for the WBM to converge towards the exact solution, the set of wave functions in (4) has to be complete. The complex exponential functions in (4) can be combined to obtain the following two sets of wave functions\n\nx)e -jkr,yy , (r -set)\n\nwith the wave numbers k a = (k a,x , k a,y ) with a = r, s defined as\n\nwhere L x and L y represent the dimensions of the smallest enclosing bounding box, around the problem domain Ω, as illustrated in figure 2. The number of DOF's of the wave model is n a = 2(n r + 1) + 2(n s + 1). The pressure approximation p, based on these wave function sets, converges [3]. Finally, only a finite number of wave functions n a can be applied. This requires the truncation of the rset and the s-set, which is wave number k dependent according to the following truncation rule\n\nwhere represents the round operator to the nearest integer towards infinity and T a user defined truncation parameter. 3 High performance implementation 3.1 Benchmark problem Consider the benchmark problem shown in figure 3, which is introduced for the comparison of the prediction results obtained by the WBM and the FEM. It consists of a 2D acoustic cavity resembling a simplified car cavity. The vertical panel at x = 0 m excites the system with a unity velocity distribution. The remaining walls are either rigid or the normal impedance is prescribed by Z = -10ρc. The ambient density and the speed of sound in the cavity are respectively ρ = 1.2 kg/m 3 and c = 344 m/s.\n\nBefore performing a detailed convergence analysis, the global dynamic behaviour of the 2D acoustic system is predicted. At positions 1 and 2 (see figure 3)\n\n1 2 a b c d e f x y in m in m ID a b c d e f 1 2 0.00 1.50 1.50 1.25 0.50 0.00 0.00 0.88 0.00 0.00 0.75 1.00 1.00 0.50 0.15 0.70 the pressure frequency response functions (FRF's) are computed, which are visualized in respectively figures 4 and 5. These figures show the results of the WBM based on both the weighted residual (WR) formulation and the least-squares (LS) formulation with phase in rad amplitude in Pa 0 500 1000 frequency in Hz -p p 10 1 10 4 WBM -WR WBM -LS FEM Figure 4: Pressure FRF at position 1 phase in rad amplitude in Pa 0 500 1000 frequency in Hz -p p 10 1 10 4 WBM -WR WBM -LS FEM Figure 5: Pressure FRF at position 2\n\nthe truncation parameter T = 2. Furthermore, the pressure FRF's are presented, which are obtained by the FEM with a model of 540 DOF's constructed with linear quadrilateral elements. In the low-frequency range, containing the first few resonance frequencies, the LS formulation of the WBM is less efficient than the WR formulation. This effect is observed in [3] too.\n\nA major advantage of the WBM is that it exhibits almost no pollution errors caused by numerically introduced dispersion. Even in the range, containing already many resonance frequencies, the resonance frequencies do not shift to higher frequencies as in case of the FEM [6]. This advantageous feature is confirmed by the validation of the numerical prediction results by measurements for a similar 3D acoustic problem [7].\n\nRegarding the pollution error, the rule of thumb [5], which states that at least 6 elements per wavelength are needed for an accurate prediction, is not satisfactory anymore for the mid-frequency applications. The maximum applicable frequency, defined as\n\nwith the maximal element size h max , is approximately f\n\n(1) max ≈ 570 Hz for the finite element model of 540 DOF's. However, figures 4 and 5 indicate that at 500 Hz already some pollution errors occur. A more conservative approximation of the maximum applicable frequency is given by [6] f (2)  max = c\n\nwith the characteristic domain dimension L. For the considered benchmark problem this results in approximately f\n\nmax ≈ 220 Hz using L = 1.7 m.\n\nThe convergence rate of the WBM and the FEM are compared for two distinct frequencies, namely for f = 380 Hz and f = 800 Hz (vertical cursors in figures 4 and 5). relative pressure difference in % number of DOF's CPU time in s 10 -2 10 -2 10 -2 10 0 10 0 10 0 10 2 10 2 10 2 10 3 FEM FEM WBM WBM PII PII HP HP point 2 point 1 FORTRAN MATLAB FORTRAN MATLAB Figure 7: Convergence curves for f = 800 Hz code processor MATLAB 650 M Hz Celeron FORTRAN 500 M Hz Pentium III SYSNOISE 400 M Hz HP-C3000 Unix SYSNOISE 450 M Hz Pentium II\n\nTable 1: Computation details for convergence analysis (see figures 6 and 7)\n\nby SYSNOISE REV 5.5 [5] (see table 1 for details).\n\nWith respect to the number of DOF's, the WBM is far more efficient than the FEM. The relative pressure differences are at least two orders of magnitude smaller and the inclination of the convergence curves is steeper. With respect to the CPU times, the WBM is still more efficient than the FEM. The error levels are at least two orders of magnitude lower for a similar amount of computation time. The high performance FORTRAN implementation is two to three times faster than the MATLAB implementation. Furthermore, the efficiency of the FORTRAN implementation can be increased further by incorporating the improvements resulting from the conceptual development, which is the topic of section 4.\n\nThe convergence behaviour of both methods depends on the response position. The global error level is similar for the considered response position, but the slope of the convergence curves differ.\n\nA sufficient condition for the WBM to converge is that the considered domain is convex [3]. However, this is not the case for most practical engineering problems. Therefore, a domain decomposition procedure has to be incorporated in the WBM. The theoretical background of the domain decomposition will be discussed briefly and its accuracy will be verified using the benchmark problem of an L-shaped domain. mains Ω 1 and Ω 2 . The boundary Γ b of each subdomain Ω b is the union of the boundary Γ bp with the prescribed pressure pb , the boundary Γ bv with the prescribed normal velocity vbn , the boundary Γ bZ with the prescribed normal impedance Zb and the interface Γ bi (Γ b = Γ bp ∪ Γ bv ∪ Γ bZ ∪ Γ bi ). The boundary conditions at Γ b \\Γ bi are defined in (2). The interface conditions for the two subdomains are given by p 1 = p 2 , at Γ 1i and L 2v (p2) = -L 1v (p 1 ), at Γ 2i with L bv = j ρω ∂ ∂n b (20) where p b represents the pressure in subdomain Ω b and ∂/∂n b the derivative in the outward-normal direction n b of subdomain Ω b . The pressure p b is approximated by the pressure approximation function pb discussed in section 2.2. The wave model is obtained by enforcing the pressure approximation pb to satisfy both the boundary conditions (2) and the interface conditions (20) in an integral sense. The wave model of the two coupled acoustic subdomains is given by A 1 + C 11 C 12 C 21 A 2 + C 22 p 1 p 2 = . . . . . . = b 1 + c 11 + c 12 b 2 + c 21 + c 22 (21) with the unknown wave contributions p ba stored in the column vectors p b . The uncoupled system matrices A b and vectors b b are defined either by respectively equation ( 9) and (10) for the WR formulation or by respectively equation ( 13) and ( 14) for the LS formulation. The derivation of the coupling matrices C and coupling vectors c is similar to the derivation of the uncoupled system matrices and vectors as discussed in section 2.3. In case of the WR formulation the coupling matrices are defined as\n\nwhere s b represents the boundary coordinate in the tangential direction s b of subdomain Ω b . The cou-pling vectors are defined as\n\nIn case of the LS formulation the coupling matrices are defined as\n\nand the coupling vectors as\n\n(25)\n\nThe accuracy of the domain decomposition is verified using the benchmark problem of the 2D L-shaped domain shown in figure 9. The acoustic system is excited by a uniform prescribed normal velocity of vn = 1 m/s at the horizontal wall at y = 2 m. The remaining walls are rigid except for the vertical wall at x = 4 m, where the normal impedance is prescribed by Z = -ρc with ρ = 1.2 kg/m 3 and c = 344 m/s.\n\nTwo response points are considered (see figure 9).\n\nThe WBM requires the division of the domain in subdomains, e.g. in three subdomains as illustrated in figure 9. Only the WR formulation of the WBM is considered here, since it is expected to be more efficient than the LS formulation. phase in rad amplitude in Pa 0 500 1000 frequency in Hz -p p 10 1 10 5 10 3 WBM FEM Another way to verify the accuracy is to check the fulfillment of the boundary conditions and the interface conditions. This can be done qualitatively for the rigid walls and the interface by visual inspection of the pressure distribution. Consider the real part of the pressure distribution for 804 Hz (mid-frequency range) shown in figure 12. The pressure contour lines are perpendicular to the rigid walls (where the normal derivative of the pressure is zero) and the pressure contour lines and their derivatives are continuous over the interfaces.\n\n-400 0 400\n\nx in m y in m rel. pressure diff. in % 10 -1 10 3 10 1 number of DOF's 10 2 10 4 number of DOF's 10 2 10 4 WBM WBM FEM FEM point 1 point 2 : 350 Hz : 804 Hz : 350 Hz : 804 Hz Figure 13: Convergence curves\n\nFinally the accuracy is verified by a convergence analysis. The convergence rate of the WBM and the FEM are compared for two distinct frequencies, namely for f = 350 Hz and f = 804 Hz (vertical cursors in figures 10 and 11). Figure 13 shows the different convergence curves at response points 1 and 2. The relative pressure difference is plotted as function of the number of DOF's. The reference solutions for the pressure difference calculation are obtained by wave models with either n a = 796 or n a = 1816 for respectively f = 350 Hz or f = 804 Hz. The comparison of the convergence curves shows that the WBM is far more efficient than the FEM, also in case of domain decomposition. The FEM results have not converged yet (more than 10% relative pressure difference). The error levels of the WBM predictions are at least two orders of magnitude lower for a similar amount of CPU time and the inclination of the convergence curves is steeper.\n\nAs mentioned in section 3.2 the WBM becomes more efficient past the low-frequency application range, certainly for the LS formulation. However, it should be mentioned that for rectangular domains both the WR and the LS formulation of the WBM show superconvergent behaviour [8]. The LS formulation suffers most from the lack of accuracy in case of domains with arbitrary geometries for the low resonance frequencies (see figures 4 and 5). The reason for this is that the current wave function set (15) cannot approximate the standing wave behaviour at the low resonance frequencies efficiently. The set of basis functions contains only a few propagating wave functions, which will contribute most to the standing wave pattern. E.g. consider the wave numbers of the r-set (16). A wave function Φ r is propagating if k r,y is a real number, otherwise Φ r is evanescent in the y-direction. E.g. in case of the 2D acoustic benchmark problem, considered in section 3, the wave functions with r > 3 are evanescent for f = 380 Hz and the total number of propagating wave functions is 14, which is the number of propagating wave functions already obtained for a truncation parameter T = 1.\n\nIn general, model refinement consists of primarily adding evanescent wave functions. The extension of the wave function set with additional propagating wave functions may improve the computational efficiency of the method. In [8] some extensions of the current wave function set are proposed, which are summarized here.\n\n1. Apply more independent enclosing bounding boxes than the smallest enclosing one for the construction of the wave function set (see figure 2). 2. Extend the current wave function set by only the propagating waves based on other independent enclosing bounding boxes. 3. Double the number of propagating wave functions based on the smallest enclosing bounding box. This requires a modification of relation (16). The verification experiments, performed on a simple 2D uncoupled acoustic problem, show that only the third proposal slightly improves the efficiency of the WBM based on the LS formulation. However, more verification experiments are required on coupled acoustic problems to investigate the capabilities of the proposed extensions to improve the computational efficiency.\n\nThe construction of a wave model involves the evaluation of complex boundary integrals (see e.g. equations ( 9) and ( 10)). In general, these evaluations are performed numerically by the application of a GAUSS integration scheme [9]. However, due to the high oscillatory behaviour of the integrand, which increases for increasing frequency, many GAUSS points are required. This results in large computational efforts for constructing a wave model. Fortunately, the integrals, which involve functions of the wave functions Φ, can be solved analytically, when the boundary geometry is either restricted to or approximated as a union of straight curves. This procedure has been applied to the generation of structural wave models [10] using the MATLAB code. The number of floating-point operations decreases significantly, but the used CPU time increases due to various conditional control statements (if-then-else) needed, which slow down the MATLAB code drastically. The FORTRAN programming language may suffer less from the lack of computational efficiency due to conditional control statements. Therefore, the application of the analytical solution functions of boundary integrals instead of the GAUSS integration scheme can improve the efficiency of the high performance FOR-TRAN implementation further.\n\nThe WBM exhibits better convergence properties than the FEM as is demonstrated in section 3. However, the applicability of the WBM is limited since the high computational efficiency only appears for acoustic systems of moderate geometrical complexity. Otherwise, the division in many small subdomains is required by means of domain decomposition (see section 4.1), which increases the computational efforts. The FEM exhibits almost no restrictions with respect to the geometrical features of a system.\n\nIn order to benefit from the advantageous features of both methods, which are the wide application range of the FEM and the high convergence rate of the WBM, the coupling between both prediction tools is proposed [11]. The basic idea is to replace those parts of the finite element model, which have a simple geometrical shape, by much smaller wave models. The resulting hybrid model has less DOF's. This allows a further model refinement of the finite element part, which leads to an improved accuracy.\n\nThe theoretical background of the proposed coupled approach is given in [11] and will be omitted here. The preliminary results of this approach applied to a 2D acoustic problem with a non-convex geometrical shape are promising. The hybrid model suffers less from pollution errors than a full finite element model with the same mesh size as the finite element part of the hybrid model. Although the research on the coupled approach is initiated recently, the preliminary results already indicate that it has the potential to cover the mid-frequency range for practical engineering problems.\n\nFirst, the theoretical background of the WBM, applied to 2D uncoupled acoustic problems, has been explained. The wave model is derived based on both the WR formulation and the LS formulation. The latter approach is less efficient certainly near the first resonance peaks in the pressure FRF's.\n\nThis paper demonstrates the computational efficiency of the method for a 2D uncoupled acoustic benchmark problem. A high accuracy compared to the finite element results is observed qualitatively by the comparison of the pressure FRF's. The WBM does not suffer from pollution errors like the FEM does. A more detailed convergence analysis shows the better convergence properties of the WBM with respect to the model sizes. Furthermore, the high performance FORTRAN implementation is also more efficient with respect to the CPU times.\n\nThe remainder of the paper discusses some research topics of the conceptual development of the WBM. Most attention goes to the domain decomposition. First the use of this approach is motivated, followed by a brief overview of the theoretical background. The accuracy of the domain decomposition is verified on a 2D acoustic L-shaped benchmark problem both by qualitative means (visual inspection) and by a detailed convergence analysis. The conclusion is that also for this considered problem the WBM, using domain decomposition, exhibits better convergence properties than the FEM. Furthermore, three extensions of the current wave function set are proposed, the replacement of the GAUSS integration procedure by analytical solution functions is considered and finally the coupling with the FEM is discussed. All new developments allow the improvement of the efficiency of the high performance FORTRAN implementation of the WBM in the future."
}
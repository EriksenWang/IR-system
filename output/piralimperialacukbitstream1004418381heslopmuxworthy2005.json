{
    "title": "Aspects of calculating First-Order Reversal Curve distributions",
    "publication_date": "1999",
    "authors": [
        {
            "full_name": "David Heslop",
            "firstname": "David",
            "lastname": "Heslop",
            "affiliations": [
                {
                    "organization": "Fachbereich Geowissenschaften, Universität Bremen",
                    "address": {
                        "city": "Bremen",
                        "country": "Germany",
                        "postcode": "D-28334"
                    }
                }
            ]
        },
        {
            "full_name": "Adrian R Muxworthy",
            "firstname": "Adrian R",
            "lastname": "Muxworthy",
            "affiliations": [
                {
                    "organization": "Grant Institute of Earth Sciences, University of Edinburgh",
                    "address": {
                        "city": "Edinburgh",
                        "country": "U.K",
                        "postcode": "EH9 3JW"
                    }
                }
            ]
        }
    ],
    "abstract": "The recent development of First-Order Reversal Curve (FORC) diagrams has allowed the detailed investigation of coercivity spectra, interactions, and domain states of fine particle magnetic systems. However, calculation of a FORC distribution from the measured magnetisation data using a second order trend surface fitted in a piecewise manner [1, 2] can be a time consuming task and it is not yet clear what criteria are suitable for selecting the level of smoothing that should be applied to the data.\nHere the convolution method of Savitzky and Golay [3] is adapted to a twodimensional form and is found to accelerate the calculation of a FORC distribution substantially (by a factor of ~500), producing results that are identical to those obtained with the existing method. To provide a quantitative measure of the deviation of a smoothed FORC diagram from the measured magnetisation data we present a simple method that allows reconstruction of the smoothed FORCs and an assessment of the signal-to-noise ratio of the data. Finally, a methodology based on spatial autocorrelation [4] is employed to determine the level of smoothing which can be performed before the smoothing process distorts the representation of the FORC distribution. In numerical tests this method appears to be highly effective in selecting smoothing levels that remove a substantial proportion of the noise contribution from the data without unduly affecting the form of the FORC distribution.",
    "full_text": "FORC diagrams are becoming an increasingly popular method of studying coercivity and interaction spectra in fine particle magnetic systems. The ability to define these spectra accurately results in a detailed magnetic characterisation of a material, and provides an insight into the sample that is not available from a standard hysteresis loop. The analysis of FORC data is still in its infancy and a number of methodological aspects must be addressed if a movement towards a full quantitative interpretation is to be made.\n\nA FORC diagram is formed by a series of partial hysteresis curves [5,6]. Each FORC is obtained by taking the material under study from a positively saturating field to a reversal point at a lower or negative field, which is defined as H a . From this reversal point the applied field, H b , is increased monotonically and the magnetisation is determined as the material returns to positive saturation. In this way the magnetisation of any given FORC is a function of both H a and H b , figure 1a. Once FORCs have been determined at a number of predefined values of H a producing the magnetisation data M(H a ,H b ) the FORC distribution can be obtained via the mixed second derivative [1,2]: The interpretation of the resultant probability density function (PDF) varies through the literature. Many authors take the distribution to be a representation of the Preisach distribution [5,6]. Alternatively, other studies have preferred to use the term FORC distribution because the determined PDFs do not conform strictly to classic Preisach theory (i.e. they are not symmetrical about the H c axis, [1,2]). Here the term FORC distribution will be employed.\n\nA number of different methods have previously been utilised to calculate FORC distributions from experimental hysteresis data. In a number of cases the mixed second derivative is simply calculated directly [6,7]. Whilst revealing the major features of the distribution this representation tends to have a large noise contribution that can mask smaller features in the data. De Wolf et al. [8] presented an optimisation method which allowed small local changes to be made to the measured data to ensure to that the mixed second derivative would produce a smoother PDF and remove regions of negative values from the distribution (which they proposed were physically meaningless).\n\nRecently, a large amount of attention has been paid to the technique of Pike et al. [1] who utilised a piecewise second-order polynomial fitting procedure to obtain smoothed versions of the FORC distribution. Working under the assumption that data points were approximately equally spaced within the H a , H b coordinate system, Pike et al. [1] defined a local grid composed of points from consecutive data points from consecutive FORCs with side 2SF+1, where SF is any given positive integer smoothing factor. A second order trend surface of the form a 1 + a 2 H a + a 3 H a 2 + a 4 H b + a 5 H b 2 + a 6 H a H b was then fitted to the data contained within the local grid in a least squares manner. In this case the value of -a 6 provides the mixed second derivative of the fitted surface and it can be assigned to the centre of the grid as a representation of the density of the FORC distribution at that point, figure 1b. This process is repeated for all grid points and a smoother version of the PDF is produced and plotted on the rotated coordinate system. If the local grid is made larger using an increased value of SF, then a smoother distribution is produced. The selection of an appropriate smoothing factor is qualitative, however, it is recommend that SF set at 2 or 3 should be sufficient for most datasets, but a maximum of SF=5 could be employed for noisy curves, [1,2]. One drawback of the method in its current form is that no assessment is made of the extent to which the smoothed data deviates from the measured points, therefore resulting in uncertainties in the relationship between the hysteresis data and the final PDF.\n\nHere we will address two aspects of the FORC procedure of Pike et al. [1] in an attempt to optimise the calculation and resolve some of the ambiguities in the smoothing procedure:\n\n1. Speed of the calculation of the smoothed FORC distribution.\n\nThe approach of using local polynomial regression to obtain derivative information from noisy data is an attractive one that has been utilised in a one-dimensional form for a number of years [9,10]. One limiting factor of the method of Pike et al. [1] is computation time, which for large grids of data can be slow. Currently the calculation is performed using two nested loops which select the data for the local grid and employ a matrix inversion to obtain a least-squares fit for the trend surface (hereafter this will be referred to as the \"Matrix Inversion\" method). Such an approach requires a total of (n 1 -SF)*(n 2 -SF) matrix inversions for a measurement grid with dimensions n 1 x n 2 , making the process computationally intensive. We propose that finding the mixed second derivative of a group of local data points by an alternative approach that only requires the inversion of a single matrix can accelerate the calculation of a FORC distribution. Savitzky and Golay [3] presented a convolution method exactly equivalent to piecewise least-squares polynomial fitting. Savitzky and Golay [3] limited their approach to smoothing and differentiation of data in one-dimension, however, such a method can be exploited in a two dimensional form to calculate rapidly smoothed FORC distributions. For brevity the full derivation of the Savitzky-Golay method will not be reviewed here, however it is based upon calculating the least-squares value for a point as a weighted combination of itself and its neighbours within a local grid. In this way a matrix inversion is only required once during the calculation of the appropriate convolution weights. It is possible to show the method by which convolution weights appropriate for the calculation of the mixed second derivative can be obtained (a short MATLAB function to perform this procedure is given in appendix 1).\n\nA coordinate system is developed for the size of the local grid over which the smoothing will be applied. The case shown is for SF = 2 and index H a = 0, H b = 0 defines the centre of the grid.\n\n-1 M(5) M(6) M(7) M(8) M(9) 0 M(10) M(11) M(12) M(13) M(14) 1 M(15) M(16) M(17) M(18) M(19) H b (i) 2 M(20) M(21) M(22) M(23) M(24)\n\nThe magnetisation data contained in the local grid can be given in the column vector:\n\nThe second-order trend surface required to calculate the FORC distribution with respect to H a and H b is given by:\n\n(eq. 3)\n\nThe polynomial coefficients can then be found by the matrix equation: M Xa % (eq. 4)\n\nwhere:\n\n24 24 24 24 24 24\n\n2 2 2 2 2 1 : : : : : : 1 1 b a b b a a b a b b a a b a b b a a H H H H H H H H H H H H H H H H H H X % and: T 6 5 4 3 2 1 ) a a a a a (a a %\n\n(eq. 5)\n\nIt is possible to determine a in a least squares manner:\n\nFinally, B gives the pseudo-inverse of X\n\n(eq. 7)\n\nThe polynomial coefficient a 6 is then given by the scalar product of the final row of B and the magnetisation vector M. The density of the distribution is given by the value -a 6 at the location corresponding to the centre of the local grid (in the case of SF = 2, this is the location of M( 12)).\n\nTo demonstrate the efficiency of this convolution approach we make a comparison of the Savitzky-Golay convolution method and the matrix inversion approach of Pike et al. [1].\n\nSquare grids of H a , H b field values and magnetisation data of various sizes were constructed and the computation time to derive the smoothed mixed second derivative for each grid was determined using the matrix inversion method and the two-dimensional Savitzky-Golay convolution method for SF = 2 and 4. The comparison was performed on a workstation with a Pentium4 1800 MHz processor and 512 MB of RAM. Computation time for each method is directly proportional to the square of the side of the data grid. Determining an improvement in the computation time for the Savitzky-Golay method it was found for SF = 2 the Savitzky-Golay method was on average ~580 times faster, whilst for SF = 4 the Savitzky-Golay method was on average ~470 times faster than the matrix inversion method, figure 3.\n\nOne limitation of Savitzky-Golay approach is the assumption that values in H a must be equally spaced and values in H b must also be equally spaced. Whilst in theory this should be simple to achieve for FORC data sets, in practise due to machine error the fields produced do not correspond to the requested field, placing the measured magnetisation data on an irregularly spaced grid of field values. In such cases it is necessary to pre-process the data using a two-dimensional interpolation to calculate the magnetisation values at points on a regular field grid. To test if such an interpolation is robust we performed a numerical experiment where a 200 x 200 grid of points was generated from the joint cumulative distribution function of a normal distribution (( = 0 and ) = 0.1) and a lognormal distribution (( = 0.1 and ) = 0.2). The joint cumulative distribution was initially calculated on a regular field grid to provide a reference data set. The irregular field grid was generated by starting with a regular grid and then adjusting the individual field values by the addition of a random value drawn from normal distribution with a mean equal to 0 and a standard deviation equal to the spacing between the field values on the regular grid multiplied by a predefined error term. The joint cumulative distribution function was then calculated for the irregular grid. The Savitzky-Golay method was applied to the data on the regular grid, data on the irregular grid and finally the data from the irregular grid after linear interpolation on to a regular grid. The results of this analysis for error terms of 0.01 and 0.05 are shown in figure 3. Error terms of these magnitudes provide a worst-case scenario, our analysis of the fields produced during real experimental FORC runs indicate that the error terms are typically < 0.001. The FORC distributions shown in figure 3 demonstrate that if the Savitzky-Golay method is inappropriately applied to data on an irregular grid with a large error term the resulting distribution is strongly deformed, however, inclusion of a pre-processing step where the data is interpolated on to a regular grid allows the method to be applied effectively.\n\nIt is important to recognise that the fitting method of Pike et al. [1] does not return the mixed second derivative of the FORC data, but instead the calculated values are the mixed second derivative of the local second-order trend surfaces that were fitted to the data.\n\nTherefore the procedure assumes that the variability of the hysteresis data conforms to a second order trend surface and as such noise free magnetisation data will not be misrepresented by the fitting procedure. Although Pike et al. [1] give no justification for their selection of a second-order trend surface as an appropriate function with which to model hysteresis data in most cases it appears to perform well in approximating measured curves. It is however essential to be able to estimate how far the smoothed data deviates from the original data in order to assess the fidelity of the calculated PDF. This point can be addressed very simply using a determination of the signal-to-noise ratio (S/N) for FORC diagrams.\n\nHere a comparison is made between measured FORC data and the smoothed FORC data that acts as the basis for the smoothed PDF. In practise reconstruction of the smoothed FORC data is simple and can be performed using the polynomial coefficients determined by the local surface fitting for each point in the (H a , H b ) grid. In FORC analysis the polynomial coefficients a 1 to a 5 are normally discarded, whilst a 6 is retained to obtain the representation of the mixed second derivative at a given point. However, calculating the value of the full polynomial expression gives the value of the magnetisation for the smoothed FORC, here termed , which can be compared to the measured value to determine the residual :\n\n(eq. 9)\n\nIn this situation the values of represent the signal and the residuals, , represent the noise contribution that has been smoothed from the data. It is important to emphasize that here we class any variance of the data that is removed from the system by the FORC smoothing procedure as noise. If the data is oversmoothed or the local grids cannot be represented by second order trend surfaces then it is possible that parts of the true signal will also be removed from the data, in such cases these removed components will still be classed using the general term, noise. These quantities allow the determination of S/N (with units decibels [12]) for the FORC diagram using equation 10.\n\n) , ( ˆb a H H M ) , ( b a M H H e dB e M N S M * * * + , ---. / % 0 0 2 2 10 log * 20 /\n\n(eq. 10)\n\nThe above ratio provides a direct measure of the deviation of the smoothed data from the measured data and the application of this procedure will be discussed below.\n\nAlthough the S/N provides a quantitative measure of the amount of smoothing that has taken place it gives no indication if an appropriate value of SF was selected. In all cases an increase in SF produces a decrease in S/N as the deviations between the original measured data and the smoothed hysteresis branches increase. It is therefore important to make an assessment of the balance between increasing the smoothness of the distribution at a cost of decreasing S/N. Ideally a SF should be selected that maximises the removal of measurement noise whilst minimising the spurious elimination of the true hysteresis signal. In the worst case the FORC data will be so oversmoothed that the calculated PDF will be distorted leading to a misrepresentation of the distribution. In a first step it should be noted that to simply quote a SF provides very little information about the smoothing which has taken place. This smoothing is related to the resolution of the data grid and it is far more meaningful to quote a bandwidth that relates the SF to the field increments of the measured data. Here we define the bandwidth of the smoothing to be the product of the field increment of the measurement and SF. To extend this idea the FORC smoothing method of Pike et al. [1] will be anisotropic unless the field increments in the H a and H b directions are the same. In cases where this condition is not met it is necessary to quote a bandwidths both for the H a and H b directions.\n\nIt is possible to detect excessive smoothing of the FORC data by performing spatial autocorrelation on the fitting residuals (eq. 9) calculated in the previous section. Spatial autocorrelation occurs when the value at a given point is not independent of the value of the points in its surroundings. Positive spatial autocorrelation indicates that similar values tend to be neighbouring each other whilst negative special autocorrelation implies different values are neighbouring each other. If the relationship between neighbouring points is random then no spatial autocorrelation exists. If noise in hysteresis data is assumed to be random (an assumption which is also made in the application of least-squares during the fitting routine) then the residuals produced by the fitting method of Pike et al. [1] should be independent and exhibit no spatial autocorrelation. In the case of inadequate smoothing where noise is still retained in the fitted data negative spatial autocorrelation will occur. However, if the data is oversmoothed regions of similar residuals will occur producing a positive spatial autocorrelation. Here we assess the spatial autocorrelation of the regression residuals using Moran's I statistic [4,13].\n\nWhere N is the number of data points, X i is the magnetisation residual at a particular location, X j is the magnetisation residual at another location and W i,j is a distance-based matrix of weights. Although the calculation of W i,j is a simple task, the size of the matrix can make the process extremely cumbersome. For N data points W i,j will have dimensions of N by N and in the case of FORC data this can result in the production of matrices with over 10 8 entries. This problem of size can be overcome using the method of Pace and Barry [14] which assumes that some points are so distant that their weighting effectively becomes zero, in this case it is possible to represent W i,j using a sparse matrix which substantially decreases memory requirements during computation.\n\nOnce a value for Moran's I of the FORC residuals is obtained it is not clear if the magnitude of the test statistic is sufficiently large to provide an indication of significant positive or negative autocorrelation. It is possible to standardise the calculated I by subtraction of the expected value E(I) of I and division by an estimate of the theoretical standard deviation under the assumption of normality [13].\n\n) ( ) ( ) ( I E S I E I I Z \" % (eq. 12)\n\nwhere:\n\nand:\n\nWe can now relate the value Z(I) to a standardised normal distribution and find autocorrelation to be significant at the 99.9% confidence level when |Z(I)| 1 3.29, where the sign of Z(I) indicates the sense of the autocorrelation. In the case of FORC data we are concerned that the magnetisation residuals do have a significant positive spatial autocorrelation because that would indicate that excessive smoothing has taken place.\n\nTo test the S/N and spatial autocorrelation methods we utilised the phenomenological mathematical model of ferromagnetic hysteresis by Takács [15]. The approach of Takács [15] provides an analytical model of the hysteresis process and as such the produced FORC curves can be considered to be free of noise (to within machine precision). This has an advantage over Monte Carlo type models that always contain some irregularities in the modelled curves because they are based on relatively small assemblages of grains. Takács [15] proposes a model for ferrimagnetic hysteresis based upon the combination of a hyperbolic and linear function:\n\nWhere 4 0 , 3 0 and 2 0 are user-defined constants, H b represents the applied field and M the magnetisation of the system. The linear part of the system will have no influence over the FORC distribution and as such we can ignore the 4 0 H b component. To simply further, 3 0 and 2 0 will be set to a value of 1. To introduce hysteresis into the system presented in eq. 14 the upper and lower branches of the loop are separated by 5H c in the horizontal and in opposite directions vertically by a constant 3 1 . The value of 3 1 is determined by the value H max , representing the point at which the upper and lower branches of the hysteresis loop intersect.\n\nThe upper and lower branches of the hysteresis loop (M upper and M lower respectively) can then be calculated.\n\nwhere:\n\nTo produce the minor loops that make up the FORC dataset an additional term is introduced which represents the reversal field, H a . It is then possible to calculate a minor loop so that after the field is reversed at H a , the path of the magnetisation will follow the descending part of the major hysteresis loop.\n\nu c b upper H H M 2 2 & \" % ) tanh( ) ( 0 for increasing B values.\n\n(eq. 17a)\n\n(eq. 17b)\n\nwhere:\n\n(eq. 18b)\n\nand:\n\nUsing this system, we constructed a FORC data set containing 120 branches with constants 2 8 = 0.5, H max = 8, figure 4. These FORCs served as a basis to which normally distributed white noise could be added to form test datasets for which the S/N and spatial autocorrelation could be determined. The magnitude of the noise added to the FORCs was defined as the magnitude of the standard deviation of the noise distribution relative to M s of the magnetisation data (in the case of the Takács model M s = 1). For example, noise with a magnitude of 0.01 was drawn from a normal distribution of random numbers with a mean of zero and a standard deviation, ) n , equal to 0.01. Tests were run for noise magnitudes at 0, 0.0001, 0.00025, 0.0005, 0.001, 0.0025 and 0.005. For each magnitude the test was repeated a total of 100 times with different noise arrays to assess the variability of the result. Figure 5 shows the results of the test runs for the different noise levels. The test results follow the pattern that is to be expected for the given data. Firstly, in all cases S/N decreases as more noise is added to the system. It is important to note that although the noise free data should have an infinite S/N the smoothed version of this data has a finite S/N because FORC data does not confirm to a piecewise second-order trend surface. Considering constant noise levels, S/N decreases with increasing SF as the smoothed data deviates more from the measured data. The standardized Z(I) values also vary as expected. In each case as SF increases the residuals move towards positive spatial autocorrelation as the data is oversmoothed. As more noise is added to the data the SF can be increased to greater values before positive spatial autocorrelation reaches a significant level. It would appear to be appropriate to select the smoothing parameter based upon the greatest value of SF which results in Z(I) 9 3.29. We can test this selection procedure by comparing the S/N of the smoothed data to the actual S/N of the data, which can be calculated in this case because the both the signal and the noise are known (i.e. the ferromagnetic model and the normally distributed random numbers respectively). The S/N for each noise level is shown in figure 5 and the spatial autocorrelation appears to provide a robust assessment for SF selection in each case. Working with the spatial autocorrelation selection procedure, SF would be set as 2, 2, 3, 3, 4, 4, and 4 for noise levels 0, 0.0001, 0.00025, 0.0005, 0.001, 0.0025 and 0.005 respectively, which is identical to the SF levels which would be chosen if we made a selection on the basis of when the smoothed data S/N is the same as the actual S/N of the data.\n\nFinally, we test the S/N and spatial autocorrelation methods on a selection of natural magnetic mineral assemblages.\n\nThe first data set comes from an approximately 1:1 mixture of a natural goethite sample, MKB, [16,17] and a natural hematite, LH6, [18]. The MKB sample consists of a goethite concentrate obtained from a marine sedimentary oolithic iron ore. Dekkers [16,17] identified an additional hematite component within the sample estimated to have a concentration of ~5%. A more recent study of this sample after storage in air for 20 years also revealed traces of magnetite that were identified by the presence of the Verwey transition in a measurement of temperature dependence of magnetic susceptibility [19]. Sample LH6 was obtained by crushing a hematite aggregate [18]. The LH6 material is thought to be almost pure hematite with a small (~0.03%) maghemite component [20]. We selected this mixture as an example for this study because the FORC data was found to be slightly noisy due to the low spontaneous magnetisation of the material. Here the results of the smoothing indicate that SF should be set at 3, figure 6, at this level the residuals are negatively autocorrelated but this is a preferable to the strong positive autocorrelation at SF=4.\n\nThe FORC data for 3 lava samples, H61-14D, H62-05B and H61-09F, taken from the 1960 Kilauea flow, Hawaii [21] were investigated. Previous work by Hill and Shaw [21] showed that the material was dominated by titanium-poor titanomagnetites with some ilmenite lamellae and abundant hemoilmenite. The FORC diagram for sample H61-14D is typical of the three samples and reveals behaviour associated to interacting SD particles [2], figure 7. Investigation of the S/N and Z(I) variability with increasing SF shows that samples H61-14D and H62-05B can be smoothed at SF=3, whilst sample H61-09F can only tolerate smoothing at SF=2 before oversmoothing occurs.\n\nWith the increasing interest in the application of FORC diagrams to natural magnetic mineral assemblages it has been necessary to address a number of points to remove some of the ambiguities in the data analysis procedure. The piecewise fitting of second-order trend surfaces to measured data can be performed efficiently using a two-dimensional form of the Savitzky-Golay convolution. This method dramatically increases the speed of the calculation and returns results that are identical to the existing slower methods. Concerning quantification of the smoothing procedure we have made two main points. Firstly, smoothing factors are more physically meaningful if they are related to the resolution of the measured data by conversion to bandwidths. Secondly, the level of smoothing can be determined quantitatively using a signal-to-noise ratio that simply relates the smoothed magnetisation data to the measured magnetisation data. Finally, we have presented a method for determining the appropriate SF for FORC distributions. This procedure uses the detection of positive spatial autocorrelation within the fitting residuals to ensure that the data are not oversmoothed and as a result there is no distortion of the underlying signal. Under an assumption of normality the residuals obtained from calculating a FORC distribution should have a standardised value of Moran's I statistic of Z(I) 9 3.29 if positive spatial autocorrelation is non-significant at the 99.9% confidence level. Investigation of the method for a series of numerical experiments and the examination of real samples shows that the SF must be selected as a balance between the ability to remove noise with the level to which the form of the FORC data can be fitted with second-order trend surfaces before it is deformed. (a) An example of a FORC originating from the reversal field, H a , and measured at various values of H b as the field returns to positive saturation. (b) A local grid of points of side SF=2, placed over consecutive FORCs and consecutive field points. A second order trend surface fitted to the local grid provides an approximation of the mixed second derivative for the central point. Computation times for various data grids at SF = 2 and 4 to compare the matrix inversion and Savitzky-Golay convolution methods. The solid lines fitted through the data points are second order polynomials. (a) Reference FORC distribution obtained from a joint cumulative distribution function calculated on a regular grid of points. In this case the assumption of equally spaced field values required by the Savitzky-Golay convolution method are met. (b) FORC distribution obtained from the joint cumulative distribution function calculated on an irregular grid of points (grid error term = 0.01). In this case the Savitzky-\n\nGolay method is incorrectly applied because the irregular spacing of the grid is not considered and as a result the obtained distribution is considerably deformed.\n\n(c) When the data on the irregular grid (error term = 0.01) are linearly interpolated onto a regular grid, the Savitzky-Golay method can be applied successfully and the correct FORC PDF is obtained.  (a) A total of 120 modelled FORC branches produced by the Takács model [15]. (b)\n\nThe FORC distribution for the model data was produced using the smoothing method of Pike et al. [1] with SF=2. Results of the numerical experiment to determine S/N and spatial autocorrelation for the Takács [15] ferromagnetic hysteresis model with different noise levels. The magnitude of the added noise, ) n is shown for each experiment and the smoothing factors are given next to the data points. Each point represents the mean of 100 runs utilising different noise arrays and the variability in the results are shown by error bars set at one standard deviation. The value of Z(I) represents the standardised spatial autocorrelation with the shading showing the region of no significant autocorrelation (99.9% confidence level). Once the data points move above the upper limit of this shaded area the fitting residuals are considered to have a positive spatial autocorrelation and it is assumed that the data have been oversmoothed. The hatched lines show the actual S/N for the data and demonstrate that spatial autocorrelation provides a robust selection procedure for SF. Results for the calculation of the FORC distribution of sample MKBLH6. Spatial autocorrelation analysis of the fitting residuals reveals that the optimum smoothing of the data is given by SF=3. Visual inspection of FORC distributions at all smoothing levels shows that  Analysis of three lava samples from the 1960 Kilauea Flow, Hawaii [21]. Analysis of the S/N verses Z(I) plot indicates that the fitting of samples H61-09F and H61-14D at SF=3 produces residuals with no significant positive spatial autocorrelation. It appears that H62-05B can tolerate less smoothing before the onset of positive spatial autocorrelation and in this case SF=2 would be selected as the suitable smoothing levels. The lower panels of the figure show the FORC distributions for sample H61-09F for SF values between 2 and 5. All FORC distributions are displayed with the same colour scale.\n\n& & & & &"
}
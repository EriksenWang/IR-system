{
    "title": "AUTOMATIC DETECTION OF CHANGES FROM LASER SCANNER AND AERIAL IMAGE DATA FOR UPDATING BUILDING MAPS",
    "publication_date": "2004",
    "authors": [
        {
            "full_name": "Leena Matikainen",
            "firstname": "Leena",
            "lastname": "Matikainen",
            "affiliations": [
                {
                    "organization": "Department of Remote Sensing and Photogrammetry, Finnish Geodetic Institute",
                    "address": {
                        "city": "Masala",
                        "country": "Finland -",
                        "postcode": "FIN-02431"
                    }
                }
            ]
        },
        {
            "full_name": "Juha Hyyppä",
            "firstname": "Juha",
            "lastname": "Hyyppä",
            "affiliations": [
                {
                    "organization": "Department of Remote Sensing and Photogrammetry, Finnish Geodetic Institute",
                    "address": {
                        "city": "Masala",
                        "country": "Finland -",
                        "postcode": "FIN-02431"
                    }
                }
            ]
        },
        {
            "full_name": "Harri Kaartinen",
            "firstname": "Harri",
            "lastname": "Kaartinen",
            "affiliations": [
                {
                    "organization": "Department of Remote Sensing and Photogrammetry, Finnish Geodetic Institute",
                    "address": {
                        "city": "Masala",
                        "country": "Finland -",
                        "postcode": "FIN-02431"
                    }
                }
            ]
        }
    ],
    "abstract": "The goal of our study was to develop an automatic change detection method based on laser scanner, aerial image and map data to be used in updating of building maps. The method was tested in a study area of 2.2 km 2 near Helsinki. Buildings were first detected by segmenting a digital surface model (DSM) derived from laser scanner data and classifying the segments as buildings, trees and ground surface. Height information, aerial image data, shape and size of the segments and neighbourhood information were used in classification. Detected buildings were then compared with an old building map and classified as new, enlarged and old buildings. Similarly, buildings of the old map were compared with the building detection result and classified as detected, partly detected and not detected. Compared with an up-to-date reference map, 88% of all buildings in the study area and 98% of buildings larger than 200 m 2 were correctly detected in the building detection stage. Promising results were also obtained in change detection between the old map and the building detection result, especially in detecting new buildings. Results of the study suggest that automatic building detection and change detection is possible and could produce useful results for map updating. Further research should include improvement of the segmentation stage to better distinguish buildings from trees and development of the change detection method.",
    "full_text": "To keep digital map databases as up-to-date as possible, efficient methods for the data acquisition and updating process are needed. Remotely sensed data provide plenty of useful and up-to-date information, and automatic extraction of different objects and land-use classes from these datasets has thus become an important research topic (see e.g. Baltsavias, 2004). During recent years, automated map updating from remotely sensed data has been studied by e.g. Hoffmann et al. (2000), Niederöst (2001), Armenakis et al. (2003), Knudsen and Olsen (2003), Jung (2004) and Walter (2004).\n\nWhen updating maps from remotely sensed data, the first task is change detection, which is carried out by interpreting the imagery and comparing the imagery and/or interpretation results with the existing map data. After change detection, new objects can be extracted, changes to existing objects made and the database updated. Automatic change detection between map and image data has been studied by e.g. Armenakis et al. (2003), Knudsen and Olsen (2003) and Walter (2004). Armenakis et al. (2003) used Landsat imagery, and the object class under study was lakes. Knudsen and Olsen (2003) used aerial photos to detect changes in buildings, and Walter (2004) used airborne digital camera data to detect changes in five landuse classes. An alternative approach to change detection is to compare two remotely sensed datasets acquired at different dates. For example, Murakami et al. (1999) used laser scanner data and Jung (2004) stereo images to detect changes in buildings.\n\nThe goal of our study is to develop a change detection method based on laser scanner, aerial image and map data for updating of building maps. The idea is to produce a preliminary updated building map that would present approximate building polygons associated with attribute information showing if the building has been built, removed or changed after the map was made. The preliminary map could then be used in further steps of map updating, e.g. verification of the changes, exact location and modelling of the buildings, updating of a map database and finally creation of a 3D city model. These further steps could be manual, semi-automatic or fully automatic. Laser scanner data were selected as the primary source of data because they have proved to be promising for building extraction and modelling (see e.g. Haala and Brenner, 1999;Maas and Vosselman, 1999;Morgan and Tempfli, 2000;Vögtle and Steinle, 2000;Fujii and Arikawa, 2002;Rottensteiner and Briese, 2003). The height information facilitates building detection and in further steps allows 3D modelling.\n\nThe change detection method discussed in the present article is based on two steps: building detection and actual change detection. Buildings are first detected using laser scanner and aerial image data. In the change detection stage, the building detection result is then compared with an existing building map to detect changes. The main parts of the method are similar to those presented in Matikainen et al. (2003). An aerial ortho image was now used in addition to laser scanner data and some changes to the building detection stage were made. The method was tested in a new study area and with a different laser scanner dataset. Up to now, the main focus of the study has been in building detection. Numerical results from comparison of the building detection results with reference data will be presented in the article. The quality of change detection results was evaluated visually.\n\nThe study area is located in Espoonlahti, Espoo, about 15-20 km west from the city of Helsinki (see also Ahokas et al., 2004;Rönnholm, 2004). The total area covered with the laser scanner and aerial image datasets is about 5 km 2 . An area of about 0.4 km 2 was selected as a training area for developing classification rules for building detection. Up to now, the building detection and change detection process has been applied to the training area and to test areas covering about 2.2 km 2 . The accuracy of building detection was estimated on the basis of the test areas, which can be roughly divided into three types of area with different characteristics: an industrial area, an apartment house area and a small-house area. Topography in the study area is varying and characterized by small hills.\n\nThe laser scanner data were acquired with the TopoSys FALCON system on 14 May 2003, when some trees were still without leaves and others had small leaves. The flying altitude was 400 m a.g.l., which resulted in a point density of about 10 points per m 2 . Due to an overlap between adjacent strips, the average point density in the dataset is about 17 points per m 2 . A digital surface model (DSM) in raster format was created from the laser scanner data using the TerraScan software (Terrasolid, 2004). To each pixel, the highest value within the pixel in the first pulse data was assigned, and interpolation was used to determine values for pixels without laser points. The original first pulse laser points were also classified in TerraScan to detect points located over 2.5 m above the ground surface. Ground points were first detected by a routine that iteratively builds a triangulated surface model (Soininen, 2003). Using another classification routine, other points were then compared with a temporary surface model based on the ground points. Classification of the points was used as a substitute for a digital terrain model (DTM) to distinguish buildings and trees from the ground surface in a later stage of the study (see Section 3.1).\n\nAn intensity image was also created from the laser scanner data. The intensity value corresponding to the highest last pulse height within the pixel was first assigned to each pixel (intensity information was not available for first pulse data), and interpolation was then applied. However, the intensity image did not appear very useful and was not used for building detection in the study. In overlap areas between different strips, the image had a grainy appearance, probably due to differences in intensity values between/across the strips.\n\nAerial colour imagery in a scale of 1:5300 were acquired and scanned by FM-Kartta Oy. The images were taken on 26 June 2003. An ortho image was created with Z/I Imaging ImageStation Base Rectifier (Z/I Imaging, 2004) using the laser-derived DSM. Comparison of the rectified image with reference data shows that buildings are accurately located. However, it must be noted that areas behind buildings or trees in the original imagery are not correctly presented. They are still covered with the building roof or tree canopy, which reduces the usefulness of the imagery for building detection.\n\nBuildings of the Topographic Database of the National Land Survey of Finland from 2000 were used as an old map to be updated. A building map from 2003 obtained from the city of Espoo was used as up-to-date reference data in rule development and accuracy estimation. The positional accuracy of objects in the Topographic Database is about 5 m (National Land Survey of Finland, 2002). Visual comparison with other data sources shows that most buildings in the study area are accurately located. The building map from the city of Espoo presents the buildings in more detail. Compared with some ground measurements in the study area, the positional accuracy of buildings in the map is 0.5 m or better. The map data were converted from vector format to raster maps. From the reference map, polygons smaller than 20 m 2 were eliminated before conversion to exclude very small buildings and other constructions from accuracy estimation. On the other hand, some smaller parts of larger buildings also became eliminated.\n\nIt must also be noted that despite its accuracy, the building map is a generalized representation of the buildings. Compared with the laser scanner data and aerial imagery, many differences can be observed. This must be accounted for when accuracy estimates calculated on the basis of the map are investigated.\n\nIn addition to the building maps, a forest map obtained from FM-Kartta Oy was used in the study. It was used in the training area in developing classification rules for building detection.\n\nThe DSM, intensity image, aerial image and map data were all processed into raster format with 30 cm x 30 cm pixels.\n\nThe building detection method was based on the following steps:\n\n1. Segmentation of the DSM into homogeneous regions 2. Classification of the segments into two classes: 'ground' and 'building or tree', based on the classified laser points (see Section 2) 3. Classification of 'building or tree' segments into buildings and trees using height texture, aerial image and shape of the segments 4. Improvement of the classification result using size of the segments and neighbourhood information in addition to the three attributes above 5. Classification-based segmentation to merge neighbouring building segments 6. Classification of the new segments based on the previous classification result Segmentation and classification, except step 2, were performed using the eCognition software (Definiens Imaging, 2004). The segmentation method of eCognition (Baatz and Schäpe, 2000;Definiens Imaging, 2003) is based on bottom-up region merging and a local optimization process minimizing the growth of a given heterogeneity criterion. A heterogeneity criterion based completely on colour information, which in this case corresponded to height in the DSM, was used.\n\nThe segments were first classified into two classes: 'ground' and 'building or tree', using the laser points classified in TerraScan. This was conducted in Matlab (The MathWorks, 2004) by calculating the number of points over and under 2.5 m above the ground surface within each segment. Within each pixel, only the highest point, which was also used in forming the DSM, was considered. The segment was classified as 'building or tree' if most of the points had a height value over 2.5 m, otherwise as 'ground'. The classification result was imported into eCognition as an additional image layer and used to classify segments into 'ground' and 'building or tree'.\n\nAttributes for distinguishing buildings and trees from each other were selected after investigating the histograms of known building and tree segments in the training area (segment was used as a training segment for building or tree if over 80% of it belonged to building or forest in the map data). Attributes under study included mean values and standard deviations of height, intensity and aerial image channels, size, various shape attributes and various texture attributes. The attributes were exported from eCognition for analysis. Three attributes were selected for classification: 1) Grey Level Co-occurrence Matrix (GLCM) homogeneity of height (texture measure), 2) mean value of the segment in the red channel of the aerial image, and 3) standard deviation of length of edges in a 'shape polygon' created on the basis of the segment. Fuzzy membership functions for classifying buildings and trees were formed on the basis of the distributions of the attributes. In classification, the three membership values for each segment were combined by calculating their mean value.\n\nThe first classification result was improved by using the size of the segments and contextual information on the classes of neighbouring segments. For example, small segments classified as buildings but mainly surrounded by trees or ground became classified as trees. This classification step was useful to correct very small, misclassified segments.\n\nAll neighbouring segments classified as buildings were merged using the classification-based segmentation operation. After this, each building segment corresponded to one entire building.\n\nThe new segments were classified on the basis of the previous result but also using the three attributes discussed above for buildings and trees. By this means, a membership value to class building, calculated on the basis of the three attributes, was obtained for each building segment.\n\nThe change detection step was conducted in Matlab, and it was based on simple comparisons between building segments found in building detection and building segments derived from the old map (the map in raster format was segmented in eCognition to obtain a segmentation in which each building is represented by one segment). Building segments detected from the laser scanner and aerial image data were divided into four classes using the following rules:\n\n• Under 10% of the building segment is covered with buildings in the map -> New building\n\n• Membership value to building in classification was > 0.75 -> Certain detection • Membership value to building in classification was ≤ 0.75 -> Uncertain detection • 10 -THR% of the building segment is covered with buildings in the map -> Enlarged building • Over THR% of the building segment is covered with buildings in the map -> Old building\n\nThe threshold value THR was selected separately for each area and was 80% for the industrial area, 70% for the apartment house area and 60% for the small-house area. Buildings of the old map were divided into three classes on the basis of the building detection result:\n\n• Over 80% of the building is covered with buildings in the classification result -> Old building detected • 10 -80% of the building is covered with buildings in the classification result -> Old building partly detected • Under 10% of the building is covered with buildings in the classification result -> Old building not detected\n\nThe final change detection results consist of two separate segmentations (new segments based on the DSM and old building segments derived from the map) with associated classifications. For visualization, a change image was formed by first plotting new and enlarged buildings from the classification result and then overlaying buildings of the old map classified as detected, partly detected or not detected (see Figures 1 and 2). The image thus shows the shape and location of old buildings as they appear in the map and the shape and location of new buildings as they were detected in building detection. In the study, the segmentation results were treated in raster format, but they can also be easily converted into vector polygons.\n\nBuilding detection results for the test areas are shown in the upper part of Figure 1. Tables 1 and 2 show the accuracy of the results compared with the reference map (a small part of the apartment house area was not covered with the reference map and was thus excluded). Results in Table 1 were obtained by comparing the classification results and reference map pixel by pixel. The accuracy measures calculated were:\n\nand\n\nwhere n CB & MB is the number of pixels labelled as buildings both in the classification result and in the map, n MB is the total number of pixels labelled as buildings in the map, and n CB is the total number of pixels labelled as buildings in the classification result.\n\nTable 1. Accuracy of building detection estimated pixel by pixel (I. is industrial area, A. apartment house area and S. small-house area, see Figure 1).\n\nAccuracy estimate Area I. A. S. All Interpretation accuracy 96.7% 94.9% 91.7% 94.2% Object accuracy 84.3% 86.1% 72.4% 80.1% Buildings classified as trees 1.6% 2.1% 5.5% 3.2% Buildings classified as ground 1.6% 3.0% 2.8% 2.6%\n\nTable 2 shows building-based accuracy estimates. In this estimation, a given overlap calculated as the percentage of the building's area was required for correct detection (e.g. over 70% of a building in the map had to be labelled as building in the classification result, or over 50% of a building in the classification result had to be labelled as building in the map).\n\nComparisons were made with different threshold values.\n\nComparisons were also made separately for large and small buildings (threshold value 200 m 2 ). Some comparisons were made by considering only 'certain' buildings of the classification result (membership value to building over 0.75). It should be noted that classification and accuracy estimation was conducted in six parts (one for the industrial area, one for the apartment house area and four for the small-house area). If a building was located on the boundary of the parts, it became considered as two (or more) separate buildings in the buildingbased accuracy estimation.  As shown by the estimates in Table 1, a relatively high accuracy was achieved. Interpretation accuracy was over 90% for each area. The highest accuracy was obtained for the industrial area (96.7%), which is natural due to the large building size. Object accuracy was lower than interpretation accuracy, ranging from 72.4% in the small-house area to 86.1% in the apartment house area. As already mentioned in Section 2, the reference map does not exactly correspond to the laser scanner and aerial image data, and part of errors result from this. It can also be observed that buildings are typically slightly smaller in the map than in the classification result, especially in the small-house area. Several reasons can be found for this behaviour: e.g. large roofs, use of first pulse data and formation of the DSM by selecting the highest point for each pixel. It is likely that the lower object accuracy in the small-house area is partly due to roof types (ridge roofs reaching over building walls typical) and generalized representation of small buildings in the map (including elimination of small polygons in data preprocessing).\n\nOn the other hand, trees growing beside and sometimes partly over buildings often became connected into same segments with buildings, which enlarged the buildings in the classification result and lowered object accuracy. The building-based accuracy estimates show that 87.6% of buildings in the map were detected when an overlap of 70% with classified buildings was required. For buildings over 200 m 2 , the detection percentage was 97.8%, and for buildings under 200 m 2 , it was 83.6%. This can be considered as a satisfactory result. Visual evaluation of buildings not detected shows that many of them are not visible or not clearly visible in the laser scanner and aerial image data, e.g. due to trees. Some buildings presented in the map are also lower than 2.5 m, which was used as a threshold value in classification. For buildings of the classification result (lower part of Table 2), the required overlap with buildings of the map had a large influence on the accuracy estimates. This is related to the larger building size in the classification result than in the map. With an overlap requirement of 70%, 58.2% of all detected buildings were correct buildings. When the overlap requirement was decreased to 50%, the percentage of correct buildings increased to 81.2%. As expected, large buildings were correct buildings more probably than small ones. The results also clearly indicate that the membership value to building from classification provides useful information on the reliability of the detected building. Of all certainly detected buildings (membership over 0.75), 95.7% with an overlap requirement of 50% were real buildings.\n\nIt can be concluded that good building detection accuracy was obtained, which is important for automated map updating. The results also indicate that the positional accuracy of detected buildings compared with the reference map was not perfectly good, which is partly related to representation of buildings in the map and characteristics of the data. Some errors in building detection, e.g. connection of buildings with trees, also occurred.\n\nThe results are in accordance with results from another study area and dataset (laser scanner data with lower pulse density, no aerial imagery). In that study (Matikainen et al., 2003), an interpretation accuracy of 90.0% and an object accuracy of 85.4% were achieved. About 80% of all buildings and about 90% of buildings larger than 200 m 2 were detected.\n\nChange detection results for the entire test areas are shown in the lower part of Figure 1 and for a selected subarea also in a larger scale in Figure 2. On the basis of visual evaluation, the following conclusions can be drawn:\n\n-Objects classified as certainly detected new buildings were normally new buildings or building-like constructions.\n\n-Objects classified as uncertainly detected new buildings were typically misclassifications.\n\n-Of 19 major new buildings in the study area, 17 were detected as new buildings with certain detection, 2 were partly classified as tree and partly as new building with uncertain detection.\n\n-Many buildings classified as enlarged or partly detected were presented differently in the old and new maps. The classification in these cases can be considered correct.\n\n-Many buildings were also classified as enlarged because they were connected into same segments with trees and/or because they appeared larger in the data sources than in the map. Some buildings were partly classified as tree and thus labelled as partly detected in change detection.\n\n-More advanced rules for detecting enlarged buildings should be developed. In some cases an enlargement of a building was correctly labelled as building in building detection, but in change detection the building was classified as an old building due to the small size of the enlargement compared with the size of the building.\n\n-Buildings classified as not detected were typically small buildings difficult to detect or two-level car parks. Many of the car parks are located on a slope with one side of the upper level on or near the ground surface and thus easily became classified as ground (e.g. the building in the upper left corner of Figure 2). -Some of the not detected old buildings did not exist in the reference map, i.e. they were correctly classified in change detection.\n\nDevelopment of the change detection method is still in an initial stage, but as described above, promising results were obtained, especially in detection of new buildings, which is the most important task for map updating.\n\nAutomatic building detection and change detection from laser scanner and aerial image data was studied. Good building detection accuracy was achieved, which was also the main goal of the study. The interpretation accuracy of buildings (pixelbased estimation) was 94%. According to building-based accuracy estimates, 88% of all buildings and 98% of buildings larger than 200 m 2 were correctly detected. Further research should include improvement of the segmentation stage to better distinguish buildings from trees (e.g. use of aerial imagery with visible and infrared channels, use of both first and last pulse laser scanner data) and development of the change detection method (e.g. matching of detected buildings with buildings of the map and use of advanced comparison strategies). However, the results obtained with the current methods in our study areas already suggest that automatic building detection and change detection is possible and could produce useful results for map updating."
}
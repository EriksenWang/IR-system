{
    "title": "Distance-Free Image Retrieval Based on Stochastic Diffusion over Bipartite Graphs",
    "publication_date": "2006",
    "authors": [
        {
            "full_name": "Christian Bauckhage",
            "firstname": "Christian",
            "lastname": "Bauckhage",
            "affiliations": [
                {
                    "organization": "Deutsche Telekom Laboratories",
                    "address": {
                        "city": "Berlin",
                        "country": "Germany",
                        "postcode": "10587"
                    }
                }
            ]
        }
    ],
    "abstract": "We propose an approach to image retrieval that does not require any distance computations. The idea is to represent images and corresponding image features by means of the two sets of vertices of a bipartite graph. Even though in such a graph the images are not directly related, the degrees to which the features are present in an image allow for defining partial orders. If the degrees of presence are normalized such that they form probability distributions, similarity rankings result from the stationary distributions of stochastic diffusion processes over the graph. The method is closely related to recent approaches to ranking on manifolds but does not involve the computation of parameterized affinity and Laplacian matrices. Experiments with a standard image retrieval data set demonstrate the efficacy of the approach. Compared to a corresponding distance-based approach, it yields a higher overall precision.",
    "full_text": "Content-based image retrieval (CBIR) from large databases has become a task of considerable practical importance. Admen, artists, designers, and journalists need fast access to appropriate icons or pictures to illustrate advertisements, journals, jingles or whatever else requires visual amelioration nowadays. However, the sheer size and speed of growth of present day image repositories create a crucial problem: consistent semantic annotations can hardly be provided single-handedly anymore. Neither can teamwork guarantee consistency. Experience with folksonomies gathered and maintained by online communities shows that spurious and ambiguous labels occur inevitably. Figure 1 illustrates what this implies in practice; it displays a choice from the 40 top ranking results obtained from typing \"tiger\" into Google's image search.\n\nState of the art retrieval systems therefore apply computer vision techniques that are fine tuned to the task at hand by means of user feedback [3,12,14]. In the so called human-in-the-loop approach, the user repeatedly rates selections of images according to how well they match the current query. Based on this relevance feedback, characteristics of appropriate and inappropriate images are determined and a hopefully better suited set of images is retrieved from the database. This interactive process continues until the user's demands are met.\n\nIn a series of influential papers, Rui and Huang [11,12] presented interactive CBIR systems based on a hierarchical model that combines different features and adaptable Figure 1: Some of the top ranking results when searching Google Images for \"tiger\". distance measures. Even though their model and many of its successors enable flexible searches for images similar to the user's intent, the way the different distances between features are defined appears to be solely technically motivated and is hard to grasp intuitively. More recent approaches [3,14] apply more sophisticated reasoning and adaptation processes, but at their heart, too, lies the problem of defining distances between images that would allow for producing similarity rankings.\n\nThe reason why we emphasize this issue here is that it became clear some time ago that sets of images of a semantic class tend to form nonlinear manifolds whose global structure cannot be captured by simple metrics (see the examples in [2,10,13]).\n\nDealing with the problem of CBIR, the question then is how define similarities between objects residing on such manifolds. Or, in other words, what is needed is a method to rank such objects. As a matter of fact, this problem has been addressed in several recent contributions [1,7,8,15,16]. It has even been studied with respect to information retrieval in general [5] and image retrieval in particular [6]. Since these approaches are closely related to the idea presented in this paper, we will discuss them in more depth later on. For now, we simply point out that all these approaches derive the global structure of a set of data by considering local relations among individual elements which are again based on some notion of distance.\n\nIn this paper, we consider only a single iteration in an interactive CBIR system and focus on the problem of image ranking. Our approach determines similarities among images but does not require any distance computations. The idea is to represent a collection of images and a set of meaningful image features by means of the two sets of vertices of a bipartite graph. Assuming the edges between images and features to denote transitions in a Markov process immediately provides an ordering scheme: if we model a user query as an initial distribution over the vertices corresponding to images, a ranking results from the stationary distribution of a corresponding Markov chain that starts from this initial state.\n\nIn the next section, we detail this idea and the computational approach. We will see that there is a simple closed form solution to compute image rankings from an arbitrary query. We will discuss that, similar to the approaches in [1,7,8,15,16], our approach leads to a graph diffusion kernel. In contrast to existing methods, however, the kernel naturally results from the probabilistic model and its derivation does not require manual adjustment of free parameters. In section 3, we present experiments that demonstrate the efficacy of the proposed approach. On a standard data set it yields useful precision and outperforms a distance-based retrieval method considered for baseline comparison. Finally, section 4 concludes this paper and points out promising next steps of research. Although there are no direct relations among the vertices u i , their relations with the vertices v j define a similarity and thus allow for partial ordering. With respect to vertex u 3 , for instance, the order is u 3 u 4 u 1 u 2\n\nThe idea for the CBIR approach presented in this paper occurred while we were exploring novel mechanisms for collaborative filtering for automatic recommender systems. In the discussion that follows, we will thus frequently resort to rather metaphorical language and make use of terms such as vote for or rate which we feel convey the underlying ideas.\n\nAssume labeled bipartite graph G = (V, E) as shown in Fig. 2. Its sets of vertices\n\nto entities (such as users, images, . . . ). In a slight abuse of notation we will identify vertices and their labels and represent a labeling of the vertices in V 1 by means of a vector u = [u 1 , u 2 , . . . , u n ] T . The m vertices v 1 , v 2 , . . . , v m in the set V 2 correspond to rated items or features that are voted for (e.g. books, RGB color bins, gradient directions, . . . ) and their labels are stored in a vector\n\nIn a recommender systems, each entity u i ∈ V 1 votes for (a subset of) the items in V 2 . Dealing with CBIR, we may think of the votes as indicators to what extend a certain feature in V 2 is present in an image represented by u i . In both cases, votes or frequency counts can be represented by means of directed, weighted edges (see Fig. 3(a)).\n\nEven though there are no immediate relations (i.e. no edges) among the elements in V 1 , their voting behavior allows for determining partial orders. Given an entity u i , its fellow entities can be ranked according to how much their voting behavior resembles the one of u i . In contrast to common distance measures between vectors of votes or frequency counts, the bipartite graph model seamlessly accounts for indirect relations as well. In the example shown in Fig. 2, for instance, u 2 is related to u 3 and u 4 alike. However, while the nature of its relation to u 4 is of first degree because both entities share a vote, its relation to u 3 is a second degree relation because it is mediated through u 4 .\n\nThe key idea is now to understand relations of arbitrary degree as the outcome of a stochastic diffusion process over the bipartite graph. To this end, we normalize the votes cast by an entity so that they sum to 1. If all the votes of all the entities are stored in a column stochastic m × n matrix R, and entity vectors are normalized so that they sum to 1, too, individual or weighted combined ratings result from v t = Ru t . With these assumptions, we obviously are considering probabilistic mappings from V 1 to V 2 . Given the transition matrix R, each item v j ∈ V 2 can deduce which entities do vote for it for this information is essentially contained in the transpose of the transition matrix. If S ∝ R T was normalized so that it is a column stochastic matrix, too, a set of rated items can (in turn) vote for entities (see Fig. 3(b)). An updated distribution over the entities in V 1 would then result from\n\nNote that the n × n matrix H introduced in last step of this derivation is a doubly stochastic matrix whose rows columns and rows sum to 1. It is square and non-negative and its eigenvalues λ k are characterized by\n\nAlso, note that H defines a Markov process over the set V 1 . Therefore, even though no direct relation among the u i ∈ V 1 were available in the first place, we now have a tool for ranking. Assume an initial distribution u 0 with only a few non zero entries. Then, after t steps, the probabilities in u t = H t u 0 will be higher for entities which are more closely related to the initially active elements and less high for less closely related ones.\n\nHowever, in this most simple form, the model cannot produce reasonable rankings if the underlying Markov chain is irreducible and contains positive-recurrent states. In this (practically very likely) case, the process converges to a uniform distribution over the elements in V 1 which does not allow for any ranking. We therefore assume the initial distribution u 0 to be a steady source of probability mass that constantly feeds the stochastic process. With this modification, the update rule for distributions is given by\n\nwhere the scaling factor 1 2 ensures that u t+1 does sum to 1 just as u t and u 0 do. With some algebra it is easy to see that, written as a power series, the recursive expression in (2) amounts to\n\nRecall that H is a doubly stochastic matrix whose eigenvalues λ k satisfy |λ k | ≤ 1. For the limit t → ∞, we therefore have\n\nHence, the iteration in equation ( 2) is guaranteed to converge. Once the process has converged, the vector u it converged to is characterized by u = 1 2 Hu + u 0 which directly leads to the closed form solution\n\nTherefore, given an arbitrary initial distribution u 0 that might represent a single entity or -just as well-a mixture of entities, we can immediately determine the corresponding stationary distribution and the ranking it implies.\n\nIt is interesting to note that the matrix in equation ( 5) constitutes a diffusion kernel [8]. In fact, from the derivation, we recognize another instance of the kernel trick. The similarities among vectors u ∈ R n that are contained in H = SR result from mapping the vectors back and forth to a (usually higher dimensional) space R m .\n\nDiffusion kernels for the purpose of computing similarities on manifolds or graphs have recently been studied by several authors [1,7,8,15,16]. In two contributions closely related to this paper, Zhou et al. [15,16], investigate the problem of ranking on manifolds. They manifolds they are concerned with are represented by means of adjacency graphs. Given an unstructured set of feature vectors, they compute a matrix that represents local structures in the data by means of the distances between each data point and its k nearest neighbors. The adjacency matrix is then transformed into a similarity matrix K using a Gaussian kernel with parameter σ . Given K, they show that diffusion processes on this adjacency graph are governed by the matrix (1α) 1 -αK -1 . This, of course, closely resembles the result in (5).\n\nIn fact, from setting α = 1 2 , we recognize stochastic diffusion over a bipartite graph to be a special case of the problem studied [15,16]. However, some comments appear to be in order. While our derivation did not involve any free parameters, the approach by Zhou et al. requires at least three of them (k, σ , α). Moreover, while our approach avoids the computation of distances between vectors of ratings or features, the approach by Zhou et al. requires distance computation for constructing the adjacency matrix as well as the corresponding similarity matrix. Finally, the matrix H in our approach is a stochastic matrix and thus allows for a concise interpretation of the ranking procedure in terms of a Markov process. The matrix K in the approach by Zhou et al., in contrast, eludes such an interpretation.\n\nRanking on manifolds has already been applied in systems for document and image retrieval [5,6]. However, to the best of our knowledge, all known such systems consider diffusion processes over adjacency graphs that represent local neighborhoods similar to the way discussed above. They therefore leave the user with the problem of choosing suitable distances and parameters. Our approach, on the other hand, is parameter-free. In the next section, we present initial experiments which demonstrate that it nevertheless yields useful results for the problem of CBIR.\n\nIn this section, we report first results obtained from our approach to image similarity ranking. Note that, in our experiments, we did not pay too much attention to the selection of features suitable for the task of CBIR. Therefore, the figures and examples presented below should not be considered the maximum achievable performance. Rather, they are meant to illustrate the potential of ranking based on diffusion over bipartite graphs.\n\nAll our experiments considered the Corel 1000 data set [9]. It contains 1000 color images showing scenes or objects from 10 different categories; for each category, there are a 100 examples.\n\nSince the idea of the degree of presence of a feature, which we alluded to in the last section, naturally translates to the use of histograms, we considered histogram-based descriptors to characterize entire images in the data set. In order to represent information due to the geometric structure of the image content, we decided to apply histograms of oriented gradients as introduced by Dalal and Triggs [4]. We used 12 bins to store gradient directions computed over a 9 × 9 grid of cells. The nonlinear normalization of different histograms was computed with respect to 3 × 3 blocks of cells. In order to represent information contained in the color distributions of the images, we adopted the idea by Dalal and Triggs to color histograms. Here, we considered 5 × 5 cells which again were normalized using 3 × 3 blocks. The color histograms in each of the cells contained 20 bins; the corresponding prototypical colors were determined from clustering the pixels of all images in the database into different sets. Other than that, no preprocessing steps were applied; in particular, we did not perform brightness adjustments or color normalization such as proposed in [4].\n\nGiven these image descriptors, we tested how our approach performed when the descriptors were considered individually as well as how it performed when they were combined into a larger vector. For baseline comparison, we also verified how a retrieval procedure performed that determines image similarities based on the cosine distance between feature vectors.\n\nThe figures in the Tables 1 to 3 resulted from issuing 10 different queries for each category and averaging over the results. In accordance with the traditional approach in information retrieval, we characterize the different algorithms in our test with respect to the precision they achieved.\n\nTables 1, 2, and 3 list the precision values at 5, at 10, and at 20, respectively, and thus indicate how many relevant documents were returned among the top 5, top 10, and top 20 ranking documents. Results obtained from the histogram of gradients features are found in the columns marked HOG, the ones obtained from histograms of colors are displayed in the columns marked HOC, results yielded by the combined descriptors are labeled both.\n\nAlthough some images seem to defy retrieval (e.g. the pictures of Mountains), the results obtained from stochastic diffusion processes over bipartite graphs generally appear reasonable and useful. Moreover, on average, our approach consistently outperforms the Table 2: Precision @ 10 obtained on the Corel 1000 data set.\n\nbaseline method, if it considers the combination of gradient and color features. Preliminary results like this are promising and justify further work on CBIR based on parameterfree diffusion over bipartite graphs. Figures. 4 through 6 exemplify another interesting and promising feature of our approach: since it avoids the computation of distances, it does not only apply to ranking with respect to individual elements on a manifold but can be seamlessly applied in order to rank with respect to sets of elements. The figures illustrate, how this can aid CBIR.\n\nIn its lower row, Fig. 4 shows the top 5 ranking images that were returned when the image in the upper row was used as the query example. The ranking resulted from using the combined gradient and color features and starting the Markov chain with an initial  distribution u 0 = [0 . . . 010 . . . 0] T . Figures 5 and 6 show the outcome of the process when started with a distribution u 0 = 1 M [0 . . . 010 . . . 010 . . . 0] T where M = 3 elements were set to 1\n\nM . From Fig. 5 we see that, if these elements index visually similar images, the retrieved images appear similar to these images, too. If the initial distribution covers a set of less similar images, the ones that will be returned among the top ranking images will also show a greater variety (see Fig. 6).\n\nIn this paper, we described a novel approach to image ranking for content-based image retrieval. The interesting characteristics of this approach are that it is parameter-free and that it determines image similarities without computing distances. Given a collection of images together with a corresponding set of normalized feature vectors, the idea is to understand both sets as the disjoint sets of vertices of a bipartite graph. If the edges between images and features are assumed to denote transitions in a Markov process and if given queries are taken to be the initial distribution, an ordering with respect to a query results  from the stationary state of the chain. By design -and in contrast to other recent approaches to manifold ranking-our approach allows for a rigorous interpretation in terms of Markov processes. Since these are completely characterized by the underlying stochastic matrix, a user does not have to adjust free parameters and distance measures. On the contrary, feature frequency counts or histograms immediately lead to necessary transition probabilities.\n\nPreliminary results obtained with this approach are promising and justify further investigation as to what features might further improve precision. In addition, the method itself offers interesting perspectives for future research. An obvious idea is to apply it to classification: given a feature vector v derived from an unknown input image and a set of known images, the new image can be classified by, for instance, a majority count of the top ranking entities in the vector u that results from a query with the initial distribution u 0 = Sv. Another direction worth pursuing further appears from noting that equation ( 2) resembles the systems one deals with in linear quadratic control. The noticeable difference is that, in equation ( 2), the control matrix is set to 1. Especially from the point of view of interactive content-based retrieval, ways of adapting this matrix to better meet the user's intent seem a worthwhile topic."
}